

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>atoMEC.postprocess package &mdash; atoMEC  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/atoMEC_favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="atoMEC package" href="atoMEC.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> atoMEC
          

          
            
            <img src="../_static/atoMEC_horizontal1.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">atoMEC</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="atoMEC.html">atoMEC package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="atoMEC.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">atoMEC.postprocess package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.check_inputs">atoMEC.check_inputs module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.config">atoMEC.config module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.convergence">atoMEC.convergence module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.mathtools">atoMEC.mathtools module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.models">atoMEC.models module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.numerov">atoMEC.numerov module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.staticKS">atoMEC.staticKS module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.unitconv">atoMEC.unitconv module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.writeoutput">atoMEC.writeoutput module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC.xc">atoMEC.xc module</a></li>
<li class="toctree-l3"><a class="reference internal" href="atoMEC.html#module-atoMEC">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">atoMEC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">atoMEC</a> &raquo;</li>
        
          <li><a href="atoMEC.html">atoMEC package</a> &raquo;</li>
        
      <li>atoMEC.postprocess package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com//atomec-project/atoMEC/blob/develop/docs/source/api/atoMEC.postprocess.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="atomec-postprocess-package">
<h1>atoMEC.postprocess package<a class="headerlink" href="#atomec-postprocess-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-atoMEC.postprocess.conductivity">
<span id="atomec-postprocess-conductivity-module"></span><h2>atoMEC.postprocess.conductivity module<a class="headerlink" href="#module-atoMEC.postprocess.conductivity" title="Permalink to this headline">¶</a></h2>
<p>The conductivity module handles routines used to model the electrical conductivity.</p>
<p>So far just the Kubo-Greenwood method is implemented.</p>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.postprocess.conductivity.KuboGreenwood" title="atoMEC.postprocess.conductivity.KuboGreenwood"><code class="xref py py-class docutils literal notranslate"><span class="pre">KuboGreenwood</span></code></a> : Holds various routines needed to compute the Kubo-Greenwood                            conducivity, including its various components. Also contains                           various properties related to the KG conducivity.</p></li>
<li><p><a class="reference internal" href="#atoMEC.postprocess.conductivity.SphHamInts" title="atoMEC.postprocess.conductivity.SphHamInts"><code class="xref py py-class docutils literal notranslate"><span class="pre">SphHamInts</span></code></a>: Holds the routines to construct angular integrals from the                        spherical harmonic functions</p></li>
<li><p><a class="reference internal" href="#atoMEC.postprocess.conductivity.RadialInts" title="atoMEC.postprocess.conductivity.RadialInts"><code class="xref py py-class docutils literal notranslate"><span class="pre">RadialInts</span></code></a>: Holds the routines to construct radial integrals from the radial                       KS orbitals</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.postprocess.conductivity.</span></span><span class="sig-name descname"><span class="pre">KuboGreenwood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbitals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valence_orbs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for Kubo-Greenwood conductivity and MIS via TRK sum rule.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.calc_eig_diff_mat">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_eig_diff_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.calc_eig_diff_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.calc_eig_diff_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix of eigenvalue differences e_l1n1 - e_ln2n2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – the KS energy eigenvalues</p></li>
<li><p><strong>orb_subset_1</strong> (<em>tuple</em>) – the first subset of orbitals (eg valence)</p></li>
<li><p><strong>orb_subset_2</strong> (<em>tuple</em>) – the second subset of orbitals (eg conduction)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>occ_diff_mat</strong> – the occupation number difference matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.calc_mel_grad_int">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_mel_grad_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb_l1n1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_l2n2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.calc_mel_grad_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.calc_mel_grad_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the matrix element <span class="math notranslate nohighlight">\(|&lt;\phi_{n1l1}|\nabla|\phi_{n1l2}&gt;|^2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orb_l1n1</strong> (<em>ndarray</em>) – l1,n1 radial KS orbital</p></li>
<li><p><strong>orb_l2n2</strong> (<em>ndarray</em>) – l2,n2 radial KS orbital</p></li>
<li><p><strong>l1</strong> (<em>int</em>) – 1st angular momentum quantum number</p></li>
<li><p><strong>n1</strong> (<em>int</em>) – 1st principal quantum number</p></li>
<li><p><strong>l2</strong> (<em>int</em>) – 2nd angular momentum quantum number</p></li>
<li><p><strong>n2</strong> (<em>int</em>) – 2nd principal quantum number</p></li>
<li><p><strong>m</strong> (<em>int</em>) – magnetic quantum number</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – log grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mel_grad_int</strong> – the matrix element <span class="math notranslate nohighlight">\(|&lt;\phi_{n1l1}|\nabla|\phi_{n1l2}&gt;|^2\)</span>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.calc_occ_diff_mat">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_occ_diff_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.calc_occ_diff_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.calc_occ_diff_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix of occupation number diffs -(f_l1n1 - f_l2n2).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the (unweighted FD) KS occupation numbers</p></li>
<li><p><strong>orb_subset_1</strong> (<em>tuple</em>) – the first subset of orbitals (eg valence)</p></li>
<li><p><strong>orb_subset_2</strong> (<em>tuple</em>) – the second subset of orbitals (eg conduction)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>occ_diff_mat</strong> – the occupation number difference matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.calc_sig">
<span class="sig-name descname"><span class="pre">calc_sig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R1_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R2_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.calc_sig"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.calc_sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <em>integrated</em> dynamical conducivity for given subsets (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R1_int</strong> (<em>ndarray</em>) – the ‘R1’ radial component of the integrand (see notes)</p></li>
<li><p><strong>R2_int</strong> (<em>ndarray</em>) – the ‘R2’ radial component of the integrand (see notes)</p></li>
<li><p><strong>orb_subset_1</strong> (<em>list of tuples</em>) – the first subset of orbitals to sum over</p></li>
<li><p><strong>orb_subset_2</strong> (<em>list of tuples</em>) – the second subset of orbitals to sum over</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sig</strong> – the integrated dynamical conductivity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function returns the integrated dynamical conductivity,
<span class="math notranslate nohighlight">\(\bar{\sigma}=\int_0^\infty d\omega \sigma(\omega)\)</span>. The conductivity
<span class="math notranslate nohighlight">\(\sigma(\omega)\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\sigma_{S_1,S2}(\omega) = \frac{2\pi}{3V\omega}
\sum_{i\in S_1}\sum_{j\in S_2} (f_i - f_j)\
|\langle\phi_{i}|\nabla|\phi_{j}\rangle|^2\delta(\epsilon_j-\epsilon_i-\omega),\]</div>
<p>where <span class="math notranslate nohighlight">\(S_1,S_2\)</span> denote the subsets of orbitals specified in the function’s
paramaters, e.g. the conduction-conduction orbitals.</p>
<p>In practise, the integral in the above equation is given by a discrete sum due
to the presenence of the dirac-delta function.</p>
<p>The paramaters <cite>R1_int</cite> and <cite>R2_int</cite> refer to radial integral components in the
calculation of the matrix elements. See the supplementary information of
Ref. <a class="footnote-reference brackets" href="#id2" id="id1">8</a> for more information on thse components, and the functions
<code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R1_int_mat()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R2_int_mat()</span></code> for their definitions.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets">8</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>,<a href="#id7">3</a>,<a href="#id9">4</a>,<a href="#id11">5</a>,<a href="#id13">6</a>,<a href="#id15">7</a>)</span></dt>
<dd><p>Callow, T.J. et al.,  “Accurate and efficient computation of mean
ionization states with an average-atom Kubo-Greenwood approach.”
arXiv preprint arXiv:2203.05863 (2022).
<a class="reference external" href="https://arxiv.org/abs/2203.05863">https://arxiv.org/abs/2203.05863</a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.calc_sig_func">
<span class="sig-name descname"><span class="pre">calc_sig_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R1_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R2_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omega_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.calc_sig_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.calc_sig_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dynamical conducivity for given subsets (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R1_int</strong> (<em>ndarray</em>) – the ‘R1’ radial component of the integrand (see notes)</p></li>
<li><p><strong>R2_int</strong> (<em>ndarray</em>) – the ‘R2’ radial component of the integrand (see notes)</p></li>
<li><p><strong>orb_subset_1</strong> (<em>list of tuples</em>) – the first subset of orbitals to sum over</p></li>
<li><p><strong>orb_subset_2</strong> (<em>list of tuples</em>) – the second subset of orbitals to sum over</p></li>
<li><p><strong>omega_max</strong> (<em>float</em>) – maximum value of the frequency grid</p></li>
<li><p><strong>n_freq</strong> (<em>int</em>) – number of points in the frequency grid</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – smoothing factor for the Lorentzian</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>sig_omega, nele</strong> –</p>
<ul class="simple">
<li><p>sig_omega: 2d array containing frequency grid and conductivity
<span class="math notranslate nohighlight">\(\sigma(\omega)\)</span></p></li>
<li><p>n_ele: the number of electrons from integration of <span class="math notranslate nohighlight">\(\sigma(\omega)\)</span>;
equivalent to N_ij (for orb subsets ij) in the limit <span class="math notranslate nohighlight">\(\gamma\to 0\)</span></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple (ndarray, float)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function returns the dynamical conductivity, <span class="math notranslate nohighlight">\(\sigma(\omega)\)</span>,
defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\sigma_{S_1,S2}(\omega) &amp;= \frac{2\pi}{3V\omega}
\sum_{i\in S_1}\sum_{j\in S_2} (f_i - f_j)\
|\langle\phi_{i}|\nabla|\phi_{j}\rangle|^2\
\mathcal{L}(\epsilon_i, \epsilon_j, \gamma, \omega) \\
\mathcal{L}(\epsilon_i, \epsilon_j, \gamma, \omega)&amp;=\
\frac{\gamma}{\pi}\frac{1}{\gamma^2+(\omega+[\epsilon_i-\epsilon_j)])^2}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(S_1,S_2\)</span> denote the subsets of orbitals specified in the function’s
paramaters, e.g. the conduction-conduction orbitals.</p>
<p>As can be seen in the above equation, the dirac-delta function in the definition
of the KG conductivity (see <cite>calc_sig</cite> function) is represented by a Lorentzian
distribution <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> to obtain a smooth conductivity function. In
the limit <span class="math notranslate nohighlight">\(\gamma\to 0\)</span>, the Lorentzian becomes a delta function.</p>
<p>The paramaters <cite>R1_int</cite> and <cite>R2_int</cite> refer to radial integral components in the
calculation of the matrix elements. See the supplementary information of
Ref. <a class="footnote-reference brackets" href="#id2" id="id3">8</a> for more information on these components, and the functions
<code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R1_int_mat()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R2_int_mat()</span></code> for their definitions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.check_sum_rule">
<span class="sig-name descname"><span class="pre">check_sum_rule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.check_sum_rule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.check_sum_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the sum rule (see notes) for an orbital <span class="math notranslate nohighlight">\(\phi_{nlm}\)</span> is satisfied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>int</em>) – angular quantum number</p></li>
<li><p><strong>n</strong> (<em>int</em>) – principal quantum number</p></li>
<li><p><strong>m</strong> (<em>int</em>) – magnetic quantum number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sum_mom</strong> – the momentum sum rule (see notes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The expression for the momentum sum rule is given by</p>
<div class="math notranslate nohighlight">
\[S_{p} = \sum_{(n_1,l_1,m_1)\neq (n,l,m)}\
\frac{|\langle\phi_{nlm}|\nabla|\phi_{n_1 l_1 m_1}\rangle|^2} {\
\epsilon_{n_1,l_1,m_1}-\epsilon_{n,l,m}}\]</div>
<p>If the sum rule is satisfied, the summation above should equal 1/2.
See Eq. (38) of Ref. <a class="footnote-reference brackets" href="#id5" id="id4">7</a> for an explanation of this sum rule.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id5"><span class="brackets">7</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id6">2</a>,<a href="#id8">3</a>,<a href="#id10">4</a>,<a href="#id12">5</a>,<a href="#id14">6</a>)</span></dt>
<dd><p>Calderin, L. et al, Kubo–Greenwood electrical conductivity formulation
and implementation for projector augmented wave datasets”, Comp. Phys Comms.
221 (2017): 118-142.
<a class="reference external" href="https://doi.org/10.1016/j.cpc.2017.08.008">DOI:doi.org/10.1016/j.cpc.2017.08.008</a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.cond_tot">
<span class="sig-name descname"><span class="pre">cond_tot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">component</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.cond_tot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.cond_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the chosen component of dynamical electrical conductivity sig(w).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>component</strong> (<em>str</em><em>, </em><em>optional</em>) – the desired component of the conducivity e.g. “cc”, “tt” etc</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>optional</em>) – smoothing factor</p></li>
<li><p><strong>maxfreq</strong> (<em>float</em><em>, </em><em>optional</em>) – maximum frequency to scan up to</p></li>
<li><p><strong>nfreq</strong> (<em>int</em><em>, </em><em>optional</em>) – number of points in the frequency grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cond_tot_</strong> – dynamical electrical conductivity</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.sig_to_N">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">sig_to_N</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#KuboGreenwood.sig_to_N"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.sig_to_N" title="Permalink to this definition">¶</a></dt>
<dd><p>Map the integrated conducivity to electron number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sig</strong> (<em>float</em>) – integrated conducivity</p></li>
<li><p><strong>V</strong> (<em>float</em>) – volume of sphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>N_ele</strong> – electron number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.N_free">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">N_free</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.N_free" title="Permalink to this definition">¶</a></dt>
<dd><p>the free electron number from TRK sum-rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.N_tot">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">N_tot</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.N_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>the total electron number from TRK sum-rule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_cc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R1_int_cc</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_cc" title="Permalink to this definition">¶</a></dt>
<dd><p>Conducting-conducting component of the R1 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_cv">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R1_int_cv</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Conducting-valence component of the R1 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_tt">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R1_int_tt</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_tt" title="Permalink to this definition">¶</a></dt>
<dd><p>Total-total component of the R1 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_vv">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R1_int_vv</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R1_int_vv" title="Permalink to this definition">¶</a></dt>
<dd><p>Valence-valence component of the R1 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_cc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R2_int_cc</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_cc" title="Permalink to this definition">¶</a></dt>
<dd><p>Conducting-conducting component of the R2 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_cv">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R2_int_cv</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Conducting-valence component of the R2 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_tt">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R2_int_tt</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_tt" title="Permalink to this definition">¶</a></dt>
<dd><p>Total-total component of the R2 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_vv">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">R2_int_vv</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.R2_int_vv" title="Permalink to this definition">¶</a></dt>
<dd><p>Valence-valence component of the R2 radial integral.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.all_orbs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">all_orbs</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.all_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>all the possible orbital pairings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.cond_orbs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">cond_orbs</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.cond_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>all the conduction band orbital pairings.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>List of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.sig_cc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">sig_cc</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.sig_cc" title="Permalink to this definition">¶</a></dt>
<dd><p>the integrated cc conductivity component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.sig_cv">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">sig_cv</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.sig_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>the integrated cv conductivity component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.sig_tot">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">sig_tot</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.sig_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>the integrated total conductivity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.sig_vv">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">sig_vv</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.sig_vv" title="Permalink to this definition">¶</a></dt>
<dd><p>the integrated vv conductivity component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.KuboGreenwood.sph_vol">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">sph_vol</span></span><a class="headerlink" href="#atoMEC.postprocess.conductivity.KuboGreenwood.sph_vol" title="Permalink to this definition">¶</a></dt>
<dd><p>the volume of the sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.RadialInts">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.postprocess.conductivity.</span></span><span class="sig-name descname"><span class="pre">RadialInts</span></span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#RadialInts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.RadialInts" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains functions required to compute various integrals of the radial KS fns.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.RadialInts.R1_int_term">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">R1_int_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_orb2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#RadialInts.R1_int_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.RadialInts.R1_int_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Input function to the <a class="reference internal" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R1_int_mat" title="atoMEC.postprocess.conductivity.RadialInts.calc_R1_int_mat"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R1_int_mat()</span></code></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfunc</strong> (<em>ndarray</em>) – KS orbital l1,n1</p></li>
<li><p><strong>grad_orb2</strong> (<em>ndarray</em>) – derivative of KS orbital l2,n2</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – log grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R1_int</strong> – the matrix element for the R1_int_mat function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.RadialInts.R2_int_term">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">R2_int_term</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfunc_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigfunc_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#RadialInts.R2_int_term"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.RadialInts.R2_int_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Input function to the <a class="reference internal" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R2_int_mat" title="atoMEC.postprocess.conductivity.RadialInts.calc_R2_int_mat"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R2_int_mat()</span></code></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfunc_1</strong> (<em>ndarray</em>) – KS orbital l1,n1</p></li>
<li><p><strong>eigfunc_2</strong> (<em>ndarray</em>) – KS orbital l2,n2</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – log grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R2_int</strong> – the matrix element for the R2_int_mat function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.RadialInts.calc_R1_int">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_R1_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#RadialInts.calc_R1_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R1_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the R1 integral between two orbitals orb1 and orb2 (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orb1</strong> (<em>ndarray</em>) – the first radial orbital</p></li>
<li><p><strong>orb2</strong> (<em>ndarray</em>) – the second radial orbital</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R1_int</strong> – the R1 integral</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See <a class="reference internal" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R1_int_mat" title="atoMEC.postprocess.conductivity.RadialInts.calc_R1_int_mat"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R1_int_mat()</span></code></a> for definition of the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.RadialInts.calc_R1_int_mat">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">calc_R1_int_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#RadialInts.calc_R1_int_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R1_int_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the ‘R1’ integral matrix (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the KS eigenfunctions</p></li>
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the KS occupation numbers</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the log grid</p></li>
<li><p><strong>orb_subset_1</strong> (<em>tuple</em>) – the first subset of orbitals (eg valence)</p></li>
<li><p><strong>orb_subset_2</strong> (<em>tuple</em>) – the second subset of orbitals (eg conduction)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R1_mat</strong> – the R1 integral matrix (see notes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The definition of the R1 integral is (see Ref. <a class="footnote-reference brackets" href="#id5" id="id6">7</a> and supplementary of <a class="footnote-reference brackets" href="#id2" id="id7">8</a>)</p>
<div class="math notranslate nohighlight">
\[R^{(1)}=4\pi\int_0^R dr r^2 X_{n_1 l_1}(r) \frac{dX_{n_2 l_2}(r)}{dr},\]</div>
<p>where <span class="math notranslate nohighlight">\(X_{nl}(r)\)</span> are the radial KS functions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.RadialInts.calc_R2_int">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_R2_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orb1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#RadialInts.calc_R2_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R2_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the R2 integral between two orbitals orb1 and orb2 (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orb1</strong> (<em>ndarray</em>) – the first radial orbital</p></li>
<li><p><strong>orb2</strong> (<em>ndarray</em>) – the second radial orbital</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R2_int</strong> – the R2 integral</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See <a class="reference internal" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R2_int_mat" title="atoMEC.postprocess.conductivity.RadialInts.calc_R2_int_mat"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_R2_int_mat()</span></code></a> for definition of the integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.RadialInts.calc_R2_int_mat">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">calc_R2_int_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orb_subset_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#RadialInts.calc_R2_int_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.RadialInts.calc_R2_int_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the ‘R2’ integral matrix (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the KS eigenfunctions</p></li>
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the KS occupation numbers</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the log grid</p></li>
<li><p><strong>orb_subset_1</strong> (<em>tuple</em>) – the first subset of orbitals (eg valence)</p></li>
<li><p><strong>orb_subset_2</strong> (<em>tuple</em>) – the second subset of orbitals (eg conduction)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>R2_mat</strong> – the R2 integral matrix (see notes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The definition of the R2 integral is (see Ref. <a class="footnote-reference brackets" href="#id5" id="id8">7</a> and supplementary of <a class="footnote-reference brackets" href="#id2" id="id9">8</a>)</p>
<div class="math notranslate nohighlight">
\[R^{(1)}=4\pi\int_0^R dr r X_{n_1 l_1}(r) X_{n_2 l_2}(r),\]</div>
<p>where <span class="math notranslate nohighlight">\(X_{nl}(r)\)</span> are the radial KS functions.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.SphHamInts">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.postprocess.conductivity.</span></span><span class="sig-name descname"><span class="pre">SphHamInts</span></span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#SphHamInts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.SphHamInts" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains the functions needed to compute various spherical harmonic integrals.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.SphHamInts.P2_func">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">P2_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#SphHamInts.P2_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.SphHamInts.P2_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the ‘P2’ function (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – input for Legendre polynomial</p></li>
<li><p><strong>l1</strong> (<em>int</em>) – 1st angular quantum number</p></li>
<li><p><strong>l2</strong> (<em>int</em>) – 2nd angular quantum number</p></li>
<li><p><strong>m</strong> (<em>int</em>) – magnetic quantum number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>P2_func_</strong> – the P2 function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The P2 function is defined as (see also Refs. <a class="footnote-reference brackets" href="#id5" id="id10">7</a> and <a class="footnote-reference brackets" href="#id2" id="id11">8</a>)</p>
<div class="math notranslate nohighlight">
\[f_p^{(2)}[l_1,l_2,m](x) = x P_{l_1}^m (x) P_{l_2}^m (x)\]</div>
<p>where P_{l}^m (x) are Legendre polynomial functions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.SphHamInts.P4_func">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">P4_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#SphHamInts.P4_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.SphHamInts.P4_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the ‘P4’ function (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – input for Legendre polynomial</p></li>
<li><p><strong>l1</strong> (<em>int</em>) – 1st angular quantum number</p></li>
<li><p><strong>l2</strong> (<em>int</em>) – 2nd angular quantum number</p></li>
<li><p><strong>m</strong> (<em>int</em>) – magnetic quantum number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>P4_func_</strong> – the P4 function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The P4 function is defined as (see also Refs. <a class="footnote-reference brackets" href="#id5" id="id12">7</a> and <a class="footnote-reference brackets" href="#id2" id="id13">8</a>)</p>
<div class="math notranslate nohighlight">
\[\begin{split}f_p^{(4)}[l_1,l_2,m](x)&amp;=-(1-x)^2 P^m_{l_1}(x) \frac{dP_{l_2}^m(x)}{dx}\\
                        &amp;= P^m_{l_1}(x) [(l_2+m)P_{l_2-1}^m(x)-xl_2\
                           P_{l_2}^m(x)]\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(P_{l}^m(x)\)</span> are Legendre polynomial functions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.SphHamInts.P_int">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">P_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#SphHamInts.P_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.SphHamInts.P_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate the P2 or P4 function (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func_int</strong> (<em>int</em>) – the desired P integral (can be 2 or 4)</p></li>
<li><p><strong>l1</strong> (<em>int</em>) – 1st angular quantum number</p></li>
<li><p><strong>l2</strong> (<em>int</em>) – 2nd angular quantum number</p></li>
<li><p><strong>m</strong> (<em>int</em>) – magnetic quantum number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>P_int_</strong> – the integrated P2 or P4 function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The integrals are defined as</p>
<div class="math notranslate nohighlight">
\[\bar{P}^{(n)}_{ll'm} = 2\pi c_{lm}c_{l'm}\int_{-1}^1 dx \
                       f_p^{(n)}[l_1,l_2,m](x)\]</div>
<p>With the functions <span class="math notranslate nohighlight">\(f_p^{(n)}(x)\)</span> defined below (<a class="reference internal" href="#atoMEC.postprocess.conductivity.SphHamInts.P2_func" title="atoMEC.postprocess.conductivity.SphHamInts.P2_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2_func()</span></code></a>
and <a class="reference internal" href="#atoMEC.postprocess.conductivity.SphHamInts.P4_func" title="atoMEC.postprocess.conductivity.SphHamInts.P4_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">P4_func()</span></code></a>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.SphHamInts.P_mat_int">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">P_mat_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func_int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#SphHamInts.P_mat_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.SphHamInts.P_mat_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix of P function (angular) integrals (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func_int</strong> (<em>int</em>) – the desired P integral (can be 2 or 4)</p></li>
<li><p><strong>lmax</strong> (<em>int</em>) – the maximum value of angular momentum</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>P_mat</strong> – matrix of P func integrals for chosen func_int</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See Refs. <a class="footnote-reference brackets" href="#id5" id="id14">7</a> and <a class="footnote-reference brackets" href="#id2" id="id15">8</a> (supplemental material) for the definitions of the
P2 and P4 functions, ands the <a class="reference internal" href="#atoMEC.postprocess.conductivity.SphHamInts.P2_func" title="atoMEC.postprocess.conductivity.SphHamInts.P2_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">P2_func()</span></code></a>, <a class="reference internal" href="#atoMEC.postprocess.conductivity.SphHamInts.P4_func" title="atoMEC.postprocess.conductivity.SphHamInts.P4_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">P4_func()</span></code></a> and
<a class="reference internal" href="#atoMEC.postprocess.conductivity.SphHamInts.P_int" title="atoMEC.postprocess.conductivity.SphHamInts.P_int"><code class="xref py py-func docutils literal notranslate"><span class="pre">P_int()</span></code></a> functions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.conductivity.SphHamInts.sph_ham_coeff">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">sph_ham_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/conductivity.html#SphHamInts.sph_ham_coeff"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.conductivity.SphHamInts.sph_ham_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute coefficients of spherical harmonic functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l</strong> (<em>int</em>) – angular quantum number</p></li>
<li><p><strong>m</strong> (<em>int</em>) – magnetic quantum number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>c_lm</strong> – coefficient for spherical harmonic function (l,m) (see notes)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The spherical harmonic functions with coefficients <span class="math notranslate nohighlight">\(c_{lm}\)</span> are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}Y_m^l(\theta,\phi) &amp;= c_{lm} P_l^m (\cos\theta) e^{im\phi}\\
c_{lm} &amp;= \sqrt{\frac{(2l+1)(l-m)!}{4\pi(l+m)!}}\end{split}\]</div>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.postprocess.localization">
<span id="atomec-postprocess-localization-module"></span><h2>atoMEC.postprocess.localization module<a class="headerlink" href="#module-atoMEC.postprocess.localization" title="Permalink to this headline">¶</a></h2>
<p>The localization module handles routines designed to measure electron localization.</p>
<div class="section" id="id16">
<h3>Classes<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.postprocess.localization.ELFTools" title="atoMEC.postprocess.localization.ELFTools"><code class="xref py py-class docutils literal notranslate"><span class="pre">ELFTools</span></code></a> : Holds functions to compute the electron localization function                      (ELF) and related quantities e.g. number of electrons per shell.</p></li>
</ul>
</div>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.postprocess.localization.calc_IPR_mat" title="atoMEC.postprocess.localization.calc_IPR_mat"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_IPR_mat()</span></code></a>: Computes the inverse participation ratio (IPR) for the orbitals.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.postprocess.localization.</span></span><span class="sig-name descname"><span class="pre">ELFTools</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbitals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'orbitals'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/localization.html#ELFTools"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>ELF is the electron localization function, a measure of electron localization.</p>
<p>It can be used as a tool for qualitative insight as well as an additional method to
compute the mean ionization state. This class contains routines to compute the ELF
and other related useful properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbitals</strong> (<a class="reference internal" href="atoMEC.html#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><em>staticKS.Orbitals</em></a>) – the orbitals object</p></li>
<li><p><strong>density</strong> (<a class="reference internal" href="atoMEC.html#atoMEC.staticKS.Density" title="atoMEC.staticKS.Density"><em>staticKS.Density</em></a>) – the density object</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.calc_ELF">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_ELF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'orbitals'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/localization.html#ELFTools.calc_ELF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.calc_ELF" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the ELF (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the (modified) KS eigenfunctions <span class="math notranslate nohighlight">\(P(x)=\exp(x/2)X(x)\)</span></p></li>
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the orbital occupations</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
<li><p><strong>density</strong> (<em>ndarray</em>) – the electron density</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ELF</strong> – the electron localization function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The ELF is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathrm{ELF}^\sigma(r) = \frac{1}{1 + (\chi^\sigma(r))^2}\,, \\
\chi^\sigma(r) = D^\sigma(r) / D^\sigma_0(r),\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(D^\sigma(r)\)</span> and <span class="math notranslate nohighlight">\(D^\sigma_0(r)\)</span> are the electron
pair density functions for the system of interest and the uniform
electron gas (UEG) respectively.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.calc_N_shell">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_N_shell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xargs_min</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ELF</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/localization.html#ELFTools.calc_N_shell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.calc_N_shell" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the number of electrons in each shell from the ELF.</p>
<p>The number of electrons per shell is determined by integrating
the electron density between successive minima of the ELF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xargs_min</strong> (<em>list</em>) – list of minima, as well as the first and last points</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
<li><p><strong>density</strong> (<em>ndarray</em>) – the electron density</p></li>
<li><p><strong>ELF</strong> (<em>ndarray</em>) – the electron localization function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>N_shell</strong> – list of the number of electrons per shell</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.calc_epdc">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_epdc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/localization.html#ELFTools.calc_epdc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.calc_epdc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the electron pair density curvature (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the (modified) KS eigenfunctions <span class="math notranslate nohighlight">\(P(x)=\exp(x/2)X(x)\)</span></p></li>
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the orbital occupations</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
<li><p><strong>density</strong> (<em>ndarray</em>) – the electron density</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epdc</strong> – the electron pair density curvature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The epdc is defined as</p>
<div class="math notranslate nohighlight">
\[D^\sigma(r) = \tau^\sigma(r) - \frac{1}{8}\frac{|\nabla\rho(r)|^2}{\rho(r)},\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau^\sigma(r)\)</span> is the local kinetic energy density.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.calc_epdc_dens">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_epdc_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/localization.html#ELFTools.calc_epdc_dens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.calc_epdc_dens" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the electron pair density curvature (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
<li><p><strong>density</strong> (<em>ndarray</em>) – the electron density</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>epdc</strong> – the electron pair density curvature</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The epdc is defined as</p>
<div class="math notranslate nohighlight">
\[D^\sigma(r) = D_0^\sigma(r) - \frac{1}{9}\frac{|\nabla\rho(r)|^2}{\rho(r)}\
+ \frac{1}{6} \nabla^2 \rho(r),\]</div>
<p>where <span class="math notranslate nohighlight">\(D_0^\sigma(r)=(3/10)(3\pi^2)^{2/3} \rho^{5/3}(r)\)</span>
is the epdc for the UEG.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.get_minima">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">get_minima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ELF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/localization.html#ELFTools.get_minima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.get_minima" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the locations of the minima of the ELF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ELF</strong> (<em>ndarray</em>) – the electron localization function</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xargs_min</strong> – list of locations of the minima and first and last points</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.ELF">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">ELF</span></span><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.ELF" title="Permalink to this definition">¶</a></dt>
<dd><p>the electron localization function for a given system.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.N_shell">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">N_shell</span></span><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.N_shell" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of electrons in each ‘shell’.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.ELFTools.epdc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">epdc</span></span><a class="headerlink" href="#atoMEC.postprocess.localization.ELFTools.epdc" title="Permalink to this definition">¶</a></dt>
<dd><p>the electron pair density curvature.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.postprocess.localization.calc_IPR_mat">
<span class="sig-prename descclassname"><span class="pre">atoMEC.postprocess.localization.</span></span><span class="sig-name descname"><span class="pre">calc_IPR_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess/localization.html#calc_IPR_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.localization.calc_IPR_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the inverse participation ratio for all eigenfunctions (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – transformed radial KS orbitals <span class="math notranslate nohighlight">\(P_{nl}(x)=\exp(x/2)X_{nl}(x)\)</span></p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>IPR_mat</strong> – the matrix of all IPR values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The inverse participation ratio for a state <cite>i</cite> is usually defined as</p>
<div class="math notranslate nohighlight">
\[\mathrm{IPR}_i = \int \mathrm{d}{\mathbf{r}} |\Psi_i(\mathbf{r})|^4\]</div>
<p>It is typically used as a localization measure.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The current definition in this version is not mathematically correct.
It does not include the proper contribution from the spherical harmonics
<span class="math notranslate nohighlight">\(|Y_l^m(\theta,\phi)|^4\)</span>. This is omitted as it makes little difference
to the flavour of the results but complicates things. Currently, this function
does not correctly produce the expected limits (even if the spherical harmonic
contribution is correctly accounted for). Use at your own peril…</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.postprocess">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-atoMEC.postprocess" title="Permalink to this headline">¶</a></h2>
<p>Everything that depends on the output from an SCF calculation.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="atoMEC.html" class="btn btn-neutral float-left" title="atoMEC package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, CASUS.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>