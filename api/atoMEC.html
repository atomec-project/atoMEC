

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>atoMEC package &mdash; atoMEC  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/atoMEC_favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="atoMEC" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> atoMEC
          

          
            
            <img src="../_static/atoMEC_horizontal1.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">atoMEC</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">atoMEC package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.check_inputs">atoMEC.check_inputs module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.config">atoMEC.config module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.convergence">atoMEC.convergence module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.mathtools">atoMEC.mathtools module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.models">atoMEC.models module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">Classes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.numerov">atoMEC.numerov module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.postprocess">atoMEC.postprocess module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.staticKS">atoMEC.staticKS module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.unitconv">atoMEC.unitconv module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.writeoutput">atoMEC.writeoutput module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id18">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC.xc">atoMEC.xc module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id20">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21">Functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-atoMEC">Module contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id22">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">atoMEC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">atoMEC</a> &raquo;</li>
        
      <li>atoMEC package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com//atomec-project/atoMEC/blob/develop/docs/source/api/atoMEC.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="atomec-package">
<h1>atoMEC package<a class="headerlink" href="#atomec-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-atoMEC.check_inputs">
<span id="atomec-check-inputs-module"></span><h2>atoMEC.check_inputs module<a class="headerlink" href="#module-atoMEC.check_inputs" title="Permalink to this headline">¶</a></h2>
<p>The check_inputs module checks the validity of all user-defined inputs.</p>
<p>If inputs are invalid, InputError exceptions are raised. It also assigns
appropriate default inputs where none are supplied.</p>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.check_inputs.Atom" title="atoMEC.check_inputs.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> : Check the inputs from the <a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">atoMEC.Atom</span></code></a> object.</p></li>
<li><p><a class="reference internal" href="#atoMEC.check_inputs.ISModel" title="atoMEC.check_inputs.ISModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ISModel</span></code></a> : Check the inputs from the <a class="reference internal" href="#atoMEC.models.ISModel" title="atoMEC.models.ISModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">atoMEC.models.ISModel</span></code></a> class.</p></li>
<li><p><a class="reference internal" href="#atoMEC.check_inputs.EnergyCalcs" title="atoMEC.check_inputs.EnergyCalcs"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyCalcs</span></code></a> : Check the inputs from the                          <a class="reference internal" href="#atoMEC.models.ISModel.CalcEnergy" title="atoMEC.models.ISModel.CalcEnergy"><code class="xref py py-func docutils literal notranslate"><span class="pre">atoMEC.models.ISModel.CalcEnergy()</span></code></a> function.</p></li>
<li><p><a class="reference internal" href="#atoMEC.check_inputs.InputError" title="atoMEC.check_inputs.InputError"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputError</span></code></a> : Exit atoMEC and print relevant input error message.</p></li>
<li><p><a class="reference internal" href="#atoMEC.check_inputs.InputWarning" title="atoMEC.check_inputs.InputWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">InputWarning</span></code></a> : Warn if inputs are considered outside of typical ranges.</p></li>
</ul>
<dl class="py exception">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.check_inputs.</span></span><span class="sig-name descname"><span class="pre">InputError</span></span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exit atoMEC and print relevant input error message.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.SCF_error">
<span class="sig-name descname"><span class="pre">SCF_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.SCF_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.SCF_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if error in SCF inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – the error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.bc_error">
<span class="sig-name descname"><span class="pre">bc_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.bc_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.bc_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if unbound not str or in permitted values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – the error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.charge_error">
<span class="sig-name descname"><span class="pre">charge_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.charge_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.charge_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if charge is not an integer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.conv_error">
<span class="sig-name descname"><span class="pre">conv_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.conv_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.conv_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if error in convergence inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – the error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.density_error">
<span class="sig-name descname"><span class="pre">density_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.density_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.density_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if density is not a float or negative.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.grid_error">
<span class="sig-name descname"><span class="pre">grid_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.grid_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.grid_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if error in grid inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – the error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.species_error">
<span class="sig-name descname"><span class="pre">species_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.species_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.species_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if there is an invalid species.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.spinmag_error">
<span class="sig-name descname"><span class="pre">spinmag_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.spinmag_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.spinmag_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if density is not a float or negative.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.spinpol_error">
<span class="sig-name descname"><span class="pre">spinpol_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.spinpol_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.spinpol_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if spinpol not a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – the error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.temp_error">
<span class="sig-name descname"><span class="pre">temp_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.temp_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.temp_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if temperature is not a float.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.unbound_error">
<span class="sig-name descname"><span class="pre">unbound_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.unbound_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.unbound_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if unbound not str or in permitted values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – the error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputError.xc_error">
<span class="sig-name descname"><span class="pre">xc_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputError.xc_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputError.xc_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise an exception if density is not a float or negative.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err_msg</strong> (<em>str</em>) – error message printed</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.check_inputs.</span></span><span class="sig-name descname"><span class="pre">Atom</span></span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Check the inputs from the Atom class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_charge">
<span class="sig-name descname"><span class="pre">check_charge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charge</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_charge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the net charge is an integer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>charge</strong> (<em>int</em>) – the net charge</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>charge</strong> – the net charge (if input valid)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.charge_error</strong> – if charge is not an integer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_density">
<span class="sig-name descname"><span class="pre">check_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the mass density is valid and reasonable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>density</strong> (<em>float</em><em> or </em><em>int</em>) – mass density (in <span class="math notranslate nohighlight">\(\mathrm{g\ cm}^{-3}\)</span>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>density</strong> – mass density (in <span class="math notranslate nohighlight">\(\mathrm{g\ cm}^{-3}\)</span>) if input accepted</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.density_error</strong> – if the density is not a positive number &lt;= 100</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_rad_dens_init">
<span class="sig-name descname"><span class="pre">check_rad_dens_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_rad_dens_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_rad_dens_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that at least one of radius or density is specified and reasonable.</p>
<p>In case both are specified, check they are compatible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Atom</strong> (<a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><em>atoMEC.Atom</em></a>) – the main Atom object</p></li>
<li><p><strong>radius</strong> (<em>float</em><em> or </em><em>int</em>) – Wigner-Seitz radius</p></li>
<li><p><strong>density</strong> (<em>float</em><em> or </em><em>int</em>) – mass density</p></li>
<li><p><strong>units_radius</strong> (<em>str</em>) – units of radius</p></li>
<li><p><strong>units_density</strong> (<em>str</em>) – units of density</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>radius, density</strong> – the Wigner-Seitz radius and mass density if inputs are valid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of floats</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.density_error</strong> – if neither density nor radius is not given, or if one is invalid,
    or if both are given and they are incompatible</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_radius">
<span class="sig-name descname"><span class="pre">check_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the Wigner-Seitz radius is valid and reasonable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<em>float</em><em> or </em><em>int</em>) – Wigner-Seitz radius (in input units)</p></li>
<li><p><strong>units_radius</strong> (<em>str</em>) – input units of radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>radius</strong> – Wigner-Seitz radius in Hartree units (Bohr)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.density_error</strong> – if the radius is not a positive number &gt; 0.1</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_species">
<span class="sig-name descname"><span class="pre">check_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_species"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the species is a string and corresponds to an actual element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>species</strong> (<em>str</em>) – chemical symbol for atomic species</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.species_error</strong> – Chemical symbol is not valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_temp">
<span class="sig-name descname"><span class="pre">check_temp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_temp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the temperature is a float within a sensible range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp</strong> (<em>float</em>) – temperature (in any accepted units)</p></li>
<li><p><strong>units_temp</strong> (<em>str</em>) – units of temperature</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>temp</strong> – temperature in units of Hartree</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>InputError.temp_error</strong> – input temperature is not a positive number</p></li>
<li><p><strong>InputWarning.temp_warning</strong> – input temperature is not inside a well-tested range</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_units_density">
<span class="sig-name descname"><span class="pre">check_units_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units_density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_units_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_units_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the units of density are accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>units_density</strong> (<em>str</em>) – units of density</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>units_density</strong> – units of density (if accepted) converted to lowercase</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.density_error</strong> – if units of density are not one of “g/cm3” or “gcm3”</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_units_radius">
<span class="sig-name descname"><span class="pre">check_units_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units_radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_units_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_units_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the units of radius are accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>units_radius</strong> (<em>str</em>) – units of radius</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>units_radius</strong> – units of radius (if accepted) converted to lowercase</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.density_error</strong> – if units of radius are not one of “bohr”, “angstrom” or “ang”</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.check_units_temp">
<span class="sig-name descname"><span class="pre">check_units_temp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">units_temp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.check_units_temp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.check_units_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the units of temperature are accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>units_temp</strong> (<em>str</em>) – units of temperature</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>units_temp</strong> – units of temperature (if valid input) converted to lowercase</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.temp_error</strong> – unit of temperature is not accepted, i.e. not one of “ha”, “ev” or “k”</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.dens_to_radius">
<span class="sig-name descname"><span class="pre">dens_to_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.dens_to_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.dens_to_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the mass density to a Wigner-Seitz radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom</strong> (<a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><em>atoMEC.Atom</em></a>) – the main Atom object</p></li>
<li><p><strong>density</strong> (<em>float</em>) – the mass density</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>radius</strong> – the Wigner-Seitz radius</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.Atom.radius_to_dens">
<span class="sig-name descname"><span class="pre">radius_to_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#Atom.radius_to_dens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.Atom.radius_to_dens" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the Voronoi sphere radius to a mass density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom</strong> (<a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><em>atoMEC.Atom</em></a>) – the main Atom object</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – the Wigner-Seitz radius</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>density</strong> – the mass density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.check_inputs.EnergyCalcs">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.check_inputs.</span></span><span class="sig-name descname"><span class="pre">EnergyCalcs</span></span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#EnergyCalcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.EnergyCalcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Check inputs for CalcEnergy calculations.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.EnergyCalcs.check_conv_params">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">check_conv_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#EnergyCalcs.check_conv_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.EnergyCalcs.check_conv_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Check convergence parameters are reasonable, or assigns if empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_params</strong> (<em>dict of floats</em>) – Can contain the keys <cite>econv</cite>, <cite>nconv</cite> and <cite>vconv</cite>, for energy,
density and potential convergence parameters</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>conv_params</strong> – dictionary of convergence parameters as follows:
{
<cite>econv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for total energy,
<cite>nconv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for density,
<cite>vconv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for electron number
}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of floats</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.conv_error</strong> – if a convergence parameter is invalid (not float or negative).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.EnergyCalcs.check_grid_params">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">check_grid_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">grid_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#EnergyCalcs.check_grid_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.EnergyCalcs.check_grid_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Check grid parameters are reasonable, or assigns if empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>grid_params</strong> (<em>dict</em>) – Can contain the keys <cite>ngrid</cite> (<code class="docutils literal notranslate"><span class="pre">int</span></code>, number of grid points)
and <cite>x0</cite> (<cite>float</cite>, LHS grid point for log grid)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grid_params</strong> – dictionary of grid parameters as follows:
{
<cite>ngrid</cite> (<code class="docutils literal notranslate"><span class="pre">int</span></code>)   : number of grid points,
<cite>x0</cite>    (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : LHS grid point takes form
<span class="math notranslate nohighlight">\(r_0=\exp(x_0)\)</span>; <span class="math notranslate nohighlight">\(x_0\)</span> can be specified
}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>InputError.grid_error</strong> – if grid inputs are invalid or outside a reasonable range</p></li>
<li><p><strong>InputError.ngrid_warning</strong> – if <cite>ngrid</cite> is outside a reasonable convergence range</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.EnergyCalcs.check_scf_params">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">check_scf_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#EnergyCalcs.check_scf_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.EnergyCalcs.check_scf_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Check scf parameters are reasonable, or assigns if empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_params</strong> (<em>dict</em>) – can contain the keys <cite>maxscf</cite> and <cite>mixfrac</cite> for max scf cycle
and potential mixing fraction</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scf_params</strong> – dictionary with the following keys:
{
<cite>maxscf</cite>   (<code class="docutils literal notranslate"><span class="pre">int</span></code>)    : max number scf cycles,
<cite>mixfrac</cite>  (<code class="docutils literal notranslate"><span class="pre">float</span></code>)    : mixing fraction
}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.SCF_error</strong> – if the SCF parameters are not of correct type or in valid range</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.check_inputs.</span></span><span class="sig-name descname"><span class="pre">ISModel</span></span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Check the inputs for the IS model class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel.calc_nele">
<span class="sig-name descname"><span class="pre">calc_nele</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nele</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spinpol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel.calc_nele"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel.calc_nele" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the electron number in each spin channel (if spin polarized).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spinmag</strong> (<em>int</em>) – the spin magnetization</p></li>
<li><p><strong>nele</strong> (<em>int</em>) – total electron number</p></li>
<li><p><strong>spinpol</strong> (<em>bool</em>) – spin polarization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>nele</strong> – number of electrons in each spin channel if spin-polarized, else
just total electron number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of ints</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel.check_bc">
<span class="sig-name descname"><span class="pre">check_bc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel.check_bc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel.check_bc" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the boundary condition is accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bc</strong> (<em>str</em>) – the boundary condition used to solve KS eqns
(can be either “dirichlet” or “neumann”)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>bc</strong> – the boundary condition used to solve KS eqns (lowercase)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.bc_error</strong> – if the boundary condition is not recognised</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel.check_spinmag">
<span class="sig-name descname"><span class="pre">check_spinmag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nele</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel.check_spinmag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel.check_spinmag" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the spin magnetization is compatible with the total electron number.</p>
<p>Also compute a default value if none is specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spinmag</strong> (<em>int</em>) – the spin magnetization (e.g. 1 for a doublet state)</p></li>
<li><p><strong>nele</strong> (<em>int</em>) – the total number of electrons</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spinmag</strong> – the spin magnetization if input valid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.spinmag_error</strong> – if spinmag input is not an integer or incompatible with electron number</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel.check_spinpol">
<span class="sig-name descname"><span class="pre">check_spinpol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel.check_spinpol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel.check_spinpol" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the spin polarization is a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>spinpol</strong> (<em>bool</em>) – whether spin polarized calculation is done</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spinpol</strong> – same as input unless error raised</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.spinpol_error</strong> – if the spin polarization is not a bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel.check_unbound">
<span class="sig-name descname"><span class="pre">check_unbound</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel.check_unbound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel.check_unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the unbound electron input is accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unbound</strong> (<em>str</em>) – defines the treatment of the unbound electrons</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>unbound</strong> – treatment of unbound electrons (if input valid)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.unbound_error</strong> – if the treatment of unbound electrons is not a valid input</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel.check_v_shift">
<span class="sig-name descname"><span class="pre">check_v_shift</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel.check_v_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel.check_v_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the potential shift is a boolean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v_shift</strong> (<em>bool</em>) – whether potential is shifted or not</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>v_shift</strong> (<em>bool</em>)</p></li>
<li><p><em>same as input unless error raised</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>InputError.v_shift_error</strong> – if the potential shift is not a bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.ISModel.check_xc">
<span class="sig-name descname"><span class="pre">check_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#ISModel.check_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.ISModel.check_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the exchange and correlation functionals are accepted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xc_func</strong> (<em>str</em><em> or </em><em>int</em>) – the libxc name or id of the x/c functional</p></li>
<li><p><strong>xc_type</strong> (<em>str</em>) – type i.e. “exchange” or “correlation”</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xc_func</strong> – the libxc name of the x/c functional (if valid input)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>InputError.xc_error</strong> – if xc functional is not a valid libxc input or is not supported
    by the current version of atoMEC</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputWarning">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.check_inputs.</span></span><span class="sig-name descname"><span class="pre">InputWarning</span></span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputWarning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputWarning" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Warn if inputs are considered outside of typical ranges, but proceed anyway.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputWarning.ngrid_warning">
<span class="sig-name descname"><span class="pre">ngrid_warning</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">err2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputWarning.ngrid_warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputWarning.ngrid_warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Warn if grid params outside of sensible range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>err1</strong> (<em>str</em>) – first custom part of error message</p></li>
<li><p><strong>err2</strong> (<em>str</em>) – second custom part of error message</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>warning</strong> – full error message</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.check_inputs.InputWarning.temp_warning">
<span class="sig-name descname"><span class="pre">temp_warning</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/check_inputs.html#InputWarning.temp_warning"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.check_inputs.InputWarning.temp_warning" title="Permalink to this definition">¶</a></dt>
<dd><p>Warn if temperature outside of sensible range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>err</strong> (<em>str</em>) – custom part of error message</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>warning</strong> – full errror message</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.config">
<span id="atomec-config-module"></span><h2>atoMEC.config module<a class="headerlink" href="#module-atoMEC.config" title="Permalink to this headline">¶</a></h2>
<p>Configuration file to store global parameters.</p>
</div>
<div class="section" id="module-atoMEC.convergence">
<span id="atomec-convergence-module"></span><h2>atoMEC.convergence module<a class="headerlink" href="#module-atoMEC.convergence" title="Permalink to this headline">¶</a></h2>
<p>Contains classes and functions used to compute and store aspects related to convergence.</p>
<p>So far, the only procedure requring convergence is the static SCF cycle. More will
be added in future.</p>
<div class="section" id="id1">
<h3>Classes<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.convergence.SCF" title="atoMEC.convergence.SCF"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code></a> : holds the SCF convergence attributes and calculates them for the                  given cycle</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.convergence.SCF">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.convergence.</span></span><span class="sig-name descname"><span class="pre">SCF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/convergence.html#SCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.convergence.SCF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Convergence attributes and functions related to SCF energy procedures.</p>
<p class="rubric">Notes</p>
<p>Contains the private attributes _energy, _potential and _density</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.convergence.SCF.check_conv">
<span class="sig-name descname"><span class="pre">check_conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E_free</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iscf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/convergence.html#SCF.check_conv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.convergence.SCF.check_conv" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and check the changes in energy, integrated density and integrated         potential.</p>
<p>If the convergence tolerances are all simultaneously satisfied, the <cite>complete</cite>         variable returns <cite>True</cite> as the SCF cycle is complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_free</strong> (<em>float</em>) – the total free energy</p></li>
<li><p><strong>v_s</strong> (<em>ndarray</em>) – the KS potential</p></li>
<li><p><strong>dens</strong> (<em>ndarray</em>) – the electronic density</p></li>
<li><p><strong>iscf</strong> (<em>int</em>) – the iteration number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>conv_vals</strong> – Dictionary of convergence parameters as follows:
{
<cite>conv_energy</cite> : <code class="docutils literal notranslate"><span class="pre">float</span></code>,   <cite>conv_rho</cite> : <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>,
<cite>conv_pot</cite>    : <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>, <cite>complete</cite> : <code class="docutils literal notranslate"><span class="pre">bool</span></code>
}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.mathtools">
<span id="atomec-mathtools-module"></span><h2>atoMEC.mathtools module<a class="headerlink" href="#module-atoMEC.mathtools" title="Permalink to this headline">¶</a></h2>
<p>Low-level module containing miscalleneous mathematical functions.</p>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.mathtools.normalize_orbs" title="atoMEC.mathtools.normalize_orbs"><code class="xref py py-func docutils literal notranslate"><span class="pre">normalize_orbs()</span></code></a>: normalize KS orbitals within defined sphere</p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.int_sphere" title="atoMEC.mathtools.int_sphere"><code class="xref py py-func docutils literal notranslate"><span class="pre">int_sphere()</span></code></a>: integral <span class="math notranslate nohighlight">\(4\pi \int \mathrm{d}r r^2 f(r)\)</span></p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.laplace" title="atoMEC.mathtools.laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">laplace()</span></code></a>: compute the second-order derivative <span class="math notranslate nohighlight">\(d^2 y(x) / dx^2\)</span></p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.fermi_dirac" title="atoMEC.mathtools.fermi_dirac"><code class="xref py py-func docutils literal notranslate"><span class="pre">fermi_dirac()</span></code></a>: compute the Fermi-Dirac occupation function for given order <cite>n</cite></p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.ideal_entropy" title="atoMEC.mathtools.ideal_entropy"><code class="xref py py-func docutils literal notranslate"><span class="pre">ideal_entropy()</span></code></a>: Define the integrand to be used in <a class="reference internal" href="#atoMEC.mathtools.ideal_entropy_int" title="atoMEC.mathtools.ideal_entropy_int"><code class="xref py py-func docutils literal notranslate"><span class="pre">ideal_entropy_int()</span></code></a>.</p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.ideal_entropy_int" title="atoMEC.mathtools.ideal_entropy_int"><code class="xref py py-func docutils literal notranslate"><span class="pre">ideal_entropy_int()</span></code></a>: Compute the entropy for the ideal electron gas (no prefac).</p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.fd_int_complete" title="atoMEC.mathtools.fd_int_complete"><code class="xref py py-func docutils literal notranslate"><span class="pre">fd_int_complete()</span></code></a>: compute the complete Fermi-Dirac integral for given order <cite>n</cite></p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.chem_pot" title="atoMEC.mathtools.chem_pot"><code class="xref py py-func docutils literal notranslate"><span class="pre">chem_pot()</span></code></a>: compute the chemical potential by enforcing charge neutrality</p></li>
<li><p><a class="reference internal" href="#atoMEC.mathtools.f_root_id" title="atoMEC.mathtools.f_root_id"><code class="xref py py-func docutils literal notranslate"><span class="pre">f_root_id()</span></code></a>: make root input fn for chem_pot with ideal apprx for free electrons</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.chem_pot">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">chem_pot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#chem_pot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.chem_pot" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine the chemical potential by enforcing charge neutrality (see notes).</p>
<p>Uses scipy.optimize.root_scalar with brentq implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbs</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><em>staticKS.Orbitals</em></a>) – the orbitals object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>mu</strong> – chemical potential (spin-dependent)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Finds the roots of equation</p>
<div class="math notranslate nohighlight">
\[\sum_{nl} (2l+1) f_{fd}(\epsilon_{nl},\beta,\mu) +
N_{ub}(\beta,\mu) - N_e = 0.\]</div>
<p>The number of unbound electrons <span class="math notranslate nohighlight">\(N_{ub}\)</span> depends on the implementation choice.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.f_root_id">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">f_root_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nele</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#f_root_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.f_root_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Functional input for the chemical potential root finding function (ideal approx).</p>
<p>See notes for function returned, the ideal approximation is used for free electrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>array_like</em>) – chemical potential</p></li>
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – the energy eigenvalues</p></li>
<li><p><strong>lbound</strong> (<em>ndarray</em>) – the lbound matrix <span class="math notranslate nohighlight">\((2l+1)\Theta(\epsilon_{nl}^\sigma)\)</span></p></li>
<li><p><strong>nele</strong> (<em>union</em><em>(</em><em>int</em><em>, </em><em>float</em><em>)</em>) – the number of electrons for given spin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f_root</strong> – the difference of the predicted electron number with given mu
and the actual electron number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The returned function is</p>
<div class="math notranslate nohighlight">
\[f = \sum_{nl} (2l+1) f_{fd}(\epsilon_{nl},\beta,\mu) +
N_{ub}(\beta,\mu) - N_e\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.f_root_qu">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">f_root_qu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lunbound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nele</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#f_root_qu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.f_root_qu" title="Permalink to this definition">¶</a></dt>
<dd><p>Functional input for the chemical potential root finding function (ideal approx).</p>
<p>See notes for function returned, the ideal approximation is used for free electrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>array_like</em>) – chemical potential</p></li>
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – the energy eigenvalues</p></li>
<li><p><strong>lbound</strong> (<em>ndarray</em>) – the lbound matrix <span class="math notranslate nohighlight">\((2l+1)\Theta(\epsilon_{nl}^\sigma)\)</span></p></li>
<li><p><strong>nele</strong> (<em>union</em><em>(</em><em>int</em><em>, </em><em>float</em><em>)</em>) – the number of electrons for given spin</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f_root</strong> – the difference of the predicted electron number with given mu
and the actual electron number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The returned function is</p>
<div class="math notranslate nohighlight">
\[f = \sum_{nl} (2l+1) f_{fd}(\epsilon_{nl},\beta,\mu) +
N_{ub}(\beta,\mu) - N_e\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.fd_int_complete">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">fd_int_complete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#fd_int_complete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.fd_int_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute complete Fermi-Dirac integral for given order (see notes for function form).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>float</em>) – chemical potential</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – inverse temperature</p></li>
<li><p><strong>n</strong> (<em>int</em>) – order of Fermi-Dirac integral (see notes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I_n</strong> – the complete fermi-dirac integral</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Complete Fermi-Dirac integrals are of the form</p>
<div class="math notranslate nohighlight">
\[I_{n}(\mu,\beta)=\int_0^\infty\mathrm{d}\epsilon\ \epsilon^{n/2}f_{fd}
(\mu,\epsilon,\beta)\]</div>
<p>where n is the order of the integral</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.fermi_dirac">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">fermi_dirac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#fermi_dirac"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.fermi_dirac" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Fermi-Dirac function, see notes for functional form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>array_like</em>) – the chemical potential</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – the inverse potential</p></li>
<li><p><strong>eps</strong> (<em>array_like</em>) – the energies</p></li>
<li><p><strong>n</strong> (<em>int</em>) – energy is raised to power n/2 in the numerator (see notes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f_fd</strong> – the fermi dirac occupation(s)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The FD function is defined as:</p>
<div class="math notranslate nohighlight">
\[f^{(n)}_{fd}(\epsilon, \mu, \beta) = \frac{\epsilon^{n/2}}{1+\exp(1+
\beta(\epsilon - \mu))}\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.ideal_entropy">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">ideal_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#ideal_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.ideal_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the integrand to be used in <a class="reference internal" href="#atoMEC.mathtools.ideal_entropy_int" title="atoMEC.mathtools.ideal_entropy_int"><code class="xref py py-func docutils literal notranslate"><span class="pre">ideal_entropy_int()</span></code></a> (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eps</strong> (<em>array_like</em>) – the energies</p></li>
<li><p><strong>mu</strong> (<em>array_like</em>) – the chemical potential</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – the inverse potential</p></li>
<li><p><strong>n</strong> (<em>int</em>) – energy is raised to power n/2 in the numerator (see notes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f_ent</strong> – the entropy integrand function</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The ideal entropy integrand is defined as</p>
<div class="math notranslate nohighlight">
\[f_n(\epsilon,\mu,\beta) = \epsilon^{n/2} (f_\mathrm{fd}\log{f_\mathrm{fd}}
+ (1-f_\mathrm{fd}) \log(1-f_\mathrm{fd}) ),\]</div>
<p>where <span class="math notranslate nohighlight">\(f_\mathrm{fd}=f_\mathrm{fd}(\epsilon,\mu,\beta)\)</span> is the Fermi-Dirac
distribution.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.ideal_entropy_int">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">ideal_entropy_int</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#ideal_entropy_int"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.ideal_entropy_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the entropy for the ideal electron gas (without prefactor) - see notes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>float</em>) – chemical potential</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – inverse temperature</p></li>
<li><p><strong>n</strong> (<em>int</em>) – order of Fermi-Dirac integral (see notes)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I_n</strong> – the complete fermi-dirac integral</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The entropy of an ideal electron gas is defined as</p>
<div class="math notranslate nohighlight">
\[I_n(\mu,\beta) = \int_0^\infty \mathrm{d}\epsilon\ \epsilon^{n/2}
(f_\mathrm{fd}\log{f_\mathrm{fd}} + (1-f_\mathrm{fd}) \log(1-f_\mathrm{fd}) ),\]</div>
<p>where <span class="math notranslate nohighlight">\(f_\mathrm{fd}=f_\mathrm{fd}(\epsilon,\mu,\beta)\)</span> is the Fermi-Dirac
distribution.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.int_sphere">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">int_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#int_sphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.int_sphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute integral over sphere defined by input grid.</p>
<p>The integral is performed on the logarithmic grid (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fx</strong> (<em>array_like</em>) – The function (array) to be integrated</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – The logarithmic radial grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>I_sph</strong> – The value of the integrand</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The integral formula is given by</p>
<div class="math notranslate nohighlight">
\[I = 4 \pi \int \mathrm{d}x\ e^{3x} f(x)\]</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.laplace">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#laplace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the second-order derivative <span class="math notranslate nohighlight">\(d^2 y(x) / dx^2\)</span>.</p>
<p>Derivative can be computed over any given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>ndarray</em>) – array y(x) on which laplacian is computed</p></li>
<li><p><strong>x</strong> (<em>ndarray</em>) – x array</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – axis over which derivatives are taken
default : -1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grad2_y</strong> – the laplacian of y</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.mathtools.normalize_orbs">
<span class="sig-prename descclassname"><span class="pre">atoMEC.mathtools.</span></span><span class="sig-name descname"><span class="pre">normalize_orbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/mathtools.html#normalize_orbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.mathtools.normalize_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the KS orbitals within the chosen sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs_x</strong> (<em>ndarray</em>) – The radial KS eigenfunctions <span class="math notranslate nohighlight">\(X_{nl}^{\sigma}(x)\)</span></p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – The logarithmic grid over which normalization is performed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eigfuncs_x_norm</strong> – The radial KS eigenfunctions normalized over the chosen sphere</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.models">
<span id="atomec-models-module"></span><h2>atoMEC.models module<a class="headerlink" href="#module-atoMEC.models" title="Permalink to this headline">¶</a></h2>
<p>Contains models used to compute properties of interest from the Atom object.</p>
<p>So far, the only model implemented is the ISModel. More models will be added in future
releases.</p>
<div class="section" id="id2">
<h3>Classes<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.models.ISModel" title="atoMEC.models.ISModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">ISModel</span></code></a> : Ion-sphere type model, static properties such as KS orbitals,                      density and energy are directly computed</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.models.ISModel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.models.</span></span><span class="sig-name descname"><span class="pre">ISModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xfunc_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lda_x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfunc_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lda_c_pw'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dirichlet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spinpol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spinmag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unbound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ideal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/models.html#ISModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.models.ISModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The ISModel represents a particular family of AA models known as ion-sphere models.</p>
<p>The implementation in atoMEC is based on the model described in <a class="footnote-reference brackets" href="#id4" id="id3">1</a>.</p>
<p>Parameter inputs for this model are related to particular choices of approximation,
e.g. boundary conditions or exchange-correlation functional, rather than
fundamental physical properties.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom</strong> (<a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><em>atoMEC.Atom</em></a>) – The main atom object</p></li>
<li><p><strong>xfunc_id</strong> (<em>str</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – The exchange functional, can be the libxc code or string,
or special internal value
Default : “lda_x”</p></li>
<li><p><strong>cfunc_id</strong> (<em>str</em><em> or </em><em>int</em><em>, </em><em>optional</em>) – The correlation functional, can be the libxc code or string, or special
internal value
Default : “lda_c_pw”</p></li>
<li><p><strong>bc</strong> (<em>str</em><em>, </em><em>optional</em>) – The boundary condition, can be “dirichlet” or “neumann”
Default : “dirichlet”</p></li>
<li><p><strong>spinpol</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to run a spin-polarized calculation
Default : False</p></li>
<li><p><strong>spinmag</strong> (<em>int</em><em>, </em><em>optional</em>) – The spin-magentization
Default: 0 for nele even, 1 for nele odd</p></li>
<li><p><strong>unbound</strong> (<em>str</em><em>, </em><em>optional</em>) – The way in which the unbound electron density is computed
Default : “ideal”</p></li>
<li><p><strong>v_shift</strong> (<em>bool</em><em>, </em><em>optional</em>) – Shifts the potential vertically by its value at the boundary, v(R_s)
Default : True</p></li>
<li><p><strong>write_info</strong> (<em>bool</em><em>, </em><em>optional</em>) – Writes information about the model parameters
Default : True</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.nele_tot">
<span class="sig-name descname"><span class="pre">nele_tot</span></span><a class="headerlink" href="#atoMEC.models.ISModel.nele_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>total number of electrons</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.nele">
<span class="sig-name descname"><span class="pre">nele</span></span><a class="headerlink" href="#atoMEC.models.ISModel.nele" title="Permalink to this definition">¶</a></dt>
<dd><p>number of electrons per spin channel (or total if spin unpolarized)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p>T. J. Callow, E. Kraisler, S. B. Hansen, and A. Cangi, (2021).
First-principles derivation and properties of density-functional
average-atom models, <a class="reference external" href="https://arxiv.org/abs/2103.09928">arXiv:2103.09928</a>.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.CalcEnergy">
<span class="sig-name descname"><span class="pre">CalcEnergy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_potential</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'density.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potential_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'potential.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_pot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/models.html#ISModel.CalcEnergy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.models.ISModel.CalcEnergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a self-consistent calculation to minimize the Kohn-Sham free energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nmax</strong> (<em>int</em>) – maximum no. eigenvalues to compute for each value of angular momentum</p></li>
<li><p><strong>lmax</strong> (<em>int</em>) – maximum no. angular momentum eigenfunctions to consider</p></li>
<li><p><strong>grid_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – dictionary of grid parameters as follows:
{
<cite>ngrid</cite> (<code class="docutils literal notranslate"><span class="pre">int</span></code>)   : number of grid points,
<cite>x0</cite>    (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : LHS grid point takes form
<span class="math notranslate nohighlight">\(r_0=\exp(x_0)\)</span>; <span class="math notranslate nohighlight">\(x_0\)</span> can be specified
}</p></li>
<li><p><strong>conv_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – dictionary of convergence parameters as follows:
{
<cite>econv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for total energy,
<cite>nconv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for density,
<cite>vconv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for electron number
}</p></li>
<li><p><strong>scf_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – dictionary for scf cycle parameters as follows:
{
<cite>maxscf</cite>  (<code class="docutils literal notranslate"><span class="pre">int</span></code>)   : maximum number of scf cycles,
<cite>mixfrac</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : density mixing fraction
}</p></li>
<li><p><strong>force_bound</strong> (<em>list of list of ints</em><em>, </em><em>optional</em>) – force certain levels to be bound, for example:
<cite>force_bound = [0, 1, 0]</cite>
forces the orbital with quantum numbers <span class="math notranslate nohighlight">\(\sigma=0,\ l=1,\ n=0\)</span> to be
always bound even if it has positive energy. This prevents convergence
issues.</p></li>
<li><p><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em>) – how much information is printed at each SCF cycle.
<cite>verbosity=0</cite> prints the total energy and convergence values (default).
<cite>verbosity=1</cite> prints the above and the KS eigenvalues and occupations.</p></li>
<li><p><strong>write_info</strong> (<em>bool</em><em>, </em><em>optional</em>) – prints the scf cycle and final parameters
default: True</p></li>
<li><p><strong>write_density</strong> (<em>bool</em><em>, </em><em>optional</em>) – writes the density to a text file
default: True</p></li>
<li><p><strong>write_potential</strong> (<em>bool</em><em>, </em><em>optional</em>) – writes the potential to a text file
default: True</p></li>
<li><p><strong>density_file</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the file to write the density to
default: <cite>density.csv</cite></p></li>
<li><p><strong>potential_file</strong> (<em>str</em><em>, </em><em>optional</em>) – name of the file to write the potential to
default: <cite>potential.csv</cite></p></li>
<li><p><strong>guess</strong> (<em>bool</em><em>, </em><em>optional</em>) – use coulomb pot (guess=False) or given pot (guess=True) as initial guess</p></li>
<li><p><strong>guess_pot</strong> (<em>numpy array</em><em>, </em><em>optional</em>) – initial guess for the potential</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_dict</strong> – dictionary containing final KS quantities as follows:
{
<cite>energy</cite> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">staticKS.Energy</span></code>)       : total energy object,
<cite>density</cite> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">staticKS.Density</span></code>)     : density object,
<cite>potential</cite> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">staticKS.Potential</span></code>)  : potential object,
<cite>orbitals</cite> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">staticKS.Orbitals</span></code>)    : orbitals object
}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.CalcPressure">
<span class="sig-name descname"><span class="pre">CalcPressure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_output</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scf_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/models.html#ISModel.CalcPressure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.models.ISModel.CalcPressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the electronic pressure using the finite differences method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom</strong> (<a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><em>atoMEC.Atom</em></a>) – The main atom object</p></li>
<li><p><strong>energy_output</strong> (<em>dict</em>) – output parameters of the function CalcEnergy</p></li>
<li><p><strong>nmax</strong> (<em>int</em>) – maximum no. eigenvalues to compute for each value of angular momentum</p></li>
<li><p><strong>lmax</strong> (<em>int</em>) – maximum no. angular momentum eigenfucntions to consider</p></li>
<li><p><strong>grid_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – dictionary of grid parameters as follows:
{
<cite>ngrid</cite> (<code class="docutils literal notranslate"><span class="pre">int</span></code>)   : number of grid points,
<cite>x0</cite>    (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : LHS grid point takes form
<span class="math notranslate nohighlight">\(r_0=\exp(x_0)\)</span>; <span class="math notranslate nohighlight">\(x_0\)</span> can be specified
}</p></li>
<li><p><strong>conv_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – dictionary of convergence parameters as follows:
{
<cite>econv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for total energy,
<cite>nconv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for density,
<cite>vconv</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : convergence for electron number
}</p></li>
<li><p><strong>scf_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – dictionary for scf cycle parameters as follows:
{
<cite>maxscf</cite>  (<code class="docutils literal notranslate"><span class="pre">int</span></code>)   : maximum number of scf cycles,
<cite>mixfrac</cite> (<code class="docutils literal notranslate"><span class="pre">float</span></code>) : density mixing fraction
}</p></li>
<li><p><strong>force_bound</strong> (<em>list of list of ints</em><em>, </em><em>optional</em>) – force certain levels to be bound, for example:
<cite>force_bound = [0, 1, 0]</cite>
forces the orbital quith quantum numbers <span class="math notranslate nohighlight">\(\sigma=0,\ l=1,\ n=0\)</span> to be
always bound even if it has positive energy. This prevents convergence
issues.</p></li>
<li><p><strong>verbosity</strong> (<em>int</em><em>, </em><em>optional</em>) – how much information is printed at each SCF cycle.
<cite>verbosity=0</cite> prints the total energy and convergence values (default)
<cite>verbosity=1</cite> prints the above and the KS eigenvalues and occupations.</p></li>
<li><p><strong>write_info</strong> (<em>bool</em><em>, </em><em>optional</em>) – prints the scf cycle and final parameters
defaults to False</p></li>
<li><p><strong>dR</strong> (<em>float</em><em>, </em><em>optional</em>) – radius difference for finite difference calculation
defaults to 0.01</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pressureHa</strong> – electronic pressure in Ha</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.bc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">bc</span></span><a class="headerlink" href="#atoMEC.models.ISModel.bc" title="Permalink to this definition">¶</a></dt>
<dd><p>boundary condition for solving the KS equations in a finite sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.cfunc_id">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">cfunc_id</span></span><a class="headerlink" href="#atoMEC.models.ISModel.cfunc_id" title="Permalink to this definition">¶</a></dt>
<dd><p>correlation functional shorthand id.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.info">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#atoMEC.models.ISModel.info" title="Permalink to this definition">¶</a></dt>
<dd><p>formatted description of the ISModel attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.spinmag">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">spinmag</span></span><a class="headerlink" href="#atoMEC.models.ISModel.spinmag" title="Permalink to this definition">¶</a></dt>
<dd><p>the spin magentization (difference in no. up/down spin electrons).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.spinpol">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">spinpol</span></span><a class="headerlink" href="#atoMEC.models.ISModel.spinpol" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether calculation will be spin-polarized.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.unbound">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">unbound</span></span><a class="headerlink" href="#atoMEC.models.ISModel.unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>the treatment of unbound/free electrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.v_shift">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">v_shift</span></span><a class="headerlink" href="#atoMEC.models.ISModel.v_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>shift the potential vertically by a constant.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.models.ISModel.xfunc_id">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">xfunc_id</span></span><a class="headerlink" href="#atoMEC.models.ISModel.xfunc_id" title="Permalink to this definition">¶</a></dt>
<dd><p>exchange functional shorthand id.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.numerov">
<span id="atomec-numerov-module"></span><h2>atoMEC.numerov module<a class="headerlink" href="#module-atoMEC.numerov" title="Permalink to this headline">¶</a></h2>
<p>The numerov module handles the routines required to solve the KS equations.</p>
<p>So far, there is only a single implementation which is based on a matrix
diagonalization. There is an option for parallelizing over the angular
quantum number <cite>l</cite>.</p>
<div class="section" id="id5">
<h3>Functions<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.numerov.matrix_solve" title="atoMEC.numerov.matrix_solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_solve()</span></code></a> : Solve the radial KS equation via matrix diagonalization of                          Numerov’s method.</p></li>
<li><p><a class="reference internal" href="#atoMEC.numerov.KS_matsolve_parallel" title="atoMEC.numerov.KS_matsolve_parallel"><code class="xref py py-func docutils literal notranslate"><span class="pre">KS_matsolve_parallel()</span></code></a> : Solve the KS matrix diagonalization by parallelizing                                  over config.ncores.</p></li>
<li><p><a class="reference internal" href="#atoMEC.numerov.KS_matsolve_serial" title="atoMEC.numerov.KS_matsolve_serial"><code class="xref py py-func docutils literal notranslate"><span class="pre">KS_matsolve_serial()</span></code></a> : Solve the KS matrix diagonalization in serial.</p></li>
<li><p><a class="reference internal" href="#atoMEC.numerov.diag_H" title="atoMEC.numerov.diag_H"><code class="xref py py-func docutils literal notranslate"><span class="pre">diag_H()</span></code></a> : Diagonalize the Hamiltonian for given input potential.</p></li>
<li><p><a class="reference internal" href="#atoMEC.numerov.update_orbs" title="atoMEC.numerov.update_orbs"><code class="xref py py-func docutils literal notranslate"><span class="pre">update_orbs()</span></code></a> : Sort the eigenvalues and functions by ascending energies and                         normalize orbs.</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.numerov.KS_matsolve_parallel">
<span class="sig-prename descclassname"><span class="pre">atoMEC.numerov.</span></span><span class="sig-name descname"><span class="pre">KS_matsolve_parallel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/numerov.html#KS_matsolve_parallel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.numerov.KS_matsolve_parallel" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the KS matrix diagonalization by parallelizing over config.ncores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<em>ndarray</em>) – kinetic energy array</p></li>
<li><p><strong>B</strong> (<em>ndarray</em>) – off-diagonal array (for RHS of eigenvalue problem)</p></li>
<li><p><strong>v</strong> (<em>ndarray</em>) – KS potential array</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – radial KS wfns</p></li>
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – KS eigenvalues</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.numerov.KS_matsolve_serial">
<span class="sig-prename descclassname"><span class="pre">atoMEC.numerov.</span></span><span class="sig-name descname"><span class="pre">KS_matsolve_serial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/numerov.html#KS_matsolve_serial"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.numerov.KS_matsolve_serial" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the KS equations via matrix diagonalization in serial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<em>ndarray</em>) – kinetic energy array</p></li>
<li><p><strong>B</strong> (<em>ndarray</em>) – off-diagonal array (for RHS of eigenvalue problem)</p></li>
<li><p><strong>v</strong> (<em>ndarray</em>) – KS potential array</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – radial KS wfns</p></li>
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – KS eigenvalues</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.numerov.diag_H">
<span class="sig-prename descclassname"><span class="pre">atoMEC.numerov.</span></span><span class="sig-name descname"><span class="pre">diag_H</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/numerov.html#diag_H"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.numerov.diag_H" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonilize the Hamiltonian for the input potential v[p].</p>
<p>Uses Scipy’s sparse matrix solver scipy.sparse.linalg.eigs. This
searches for the lowest magnitude <cite>nmax</cite> eigenvalues, so care
must be taken to converge calculations wrt <cite>nmax</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>int</em>) – the desired index of the input array v to solve for</p></li>
<li><p><strong>T</strong> (<em>ndarray</em>) – the kinetic energy matrix</p></li>
<li><p><strong>B</strong> (<em>ndarray</em>) – the off diagonal matrix multiplying V and RHS</p></li>
<li><p><strong>v</strong> (<em>ndarray</em>) – KS potential array</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
<li><p><strong>nmax</strong> (<em>int</em>) – number of eigenvalues returned by the sparse matrix diagonalization</p></li>
<li><p><strong>bc</strong> (<em>str</em>) – the boundary condition</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>evecs</strong> (<em>ndarray</em>) – the KS radial eigenfunctions</p></li>
<li><p><strong>evals</strong> (<em>ndarray</em>) – the KS eigenvalues</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.numerov.matrix_solve">
<span class="sig-prename descclassname"><span class="pre">atoMEC.numerov.</span></span><span class="sig-name descname"><span class="pre">matrix_solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/numerov.html#matrix_solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.numerov.matrix_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the radial KS equation via matrix diagonalization of Numerov’s method.</p>
<p>See notes for details of the implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> (<em>ndarray</em>) – the KS potential on the log grid</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the radial KS eigenfunctions on the log grid</p></li>
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – the KS eigenvalues</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The implementation is based on <a class="footnote-reference brackets" href="#id8" id="id6">2</a>.</p>
<p>The matrix diagonalization is of the form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\hat{H} \lvert X \rangle &amp;= \lambda \hat{B} \lvert X \rangle\ , \\
\hat{H}                  &amp;= \hat{T} + \hat{B}\times\hat{V}\ ,   \\
\hat{T}                  &amp;= -0.5\times\hat{p}\times\hat{A}\ .\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hat{p}=\exp(-2x)\)</span>.
See <a class="footnote-reference brackets" href="#id8" id="id7">2</a> for the definitions of the matrices <span class="math notranslate nohighlight">\(\hat{A}\)</span> and <span class="math notranslate nohighlight">\(\hat{B}\)</span>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id8"><span class="brackets">2</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id7">2</a>)</span></dt>
<dd><p>M. Pillai, J. Goglio, and T. G. Walker , Matrix Numerov method for solving
Schrödinger’s equation, American Journal of Physics 80,
1017-1019 (2012) <a class="reference external" href="https://doi.org/10.1119/1.4748813">DOI:10.1119/1.4748813</a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.numerov.update_orbs">
<span class="sig-prename descclassname"><span class="pre">atoMEC.numerov.</span></span><span class="sig-name descname"><span class="pre">update_orbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">l_eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/numerov.html#update_orbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.numerov.update_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the eigenvalues and functions by ascending energies and normalize orbs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>l_eigfuncs</strong> (<em>ndarray</em>) – input (unsorted and unnormalized) eigenfunctions (for given l and spin)</p></li>
<li><p><strong>l_eigvals</strong> (<em>ndarray</em>) – input (unsorted) eigenvalues (for given l and spin)</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
<li><p><strong>bc</strong> (<em>str</em>) – the boundary condition</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – sorted and normalized eigenfunctions</p></li>
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – sorted eigenvalues in ascending energy</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.postprocess">
<span id="atomec-postprocess-module"></span><h2>atoMEC.postprocess module<a class="headerlink" href="#module-atoMEC.postprocess" title="Permalink to this headline">¶</a></h2>
<p>Module containing routines to post-process data from AA calculations.</p>
<div class="section" id="id9">
<h3>Functions<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">IPR</span></code> : Holds the inverse participation ratio, derived quantities and                  the routines required to compute them.</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.postprocess.calc_IPR_mat">
<span class="sig-prename descclassname"><span class="pre">atoMEC.postprocess.</span></span><span class="sig-name descname"><span class="pre">calc_IPR_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/postprocess.html#calc_IPR_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.postprocess.calc_IPR_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the inverse participation ratio for all eigenfunctions (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – transformed radial KS orbitals <span class="math notranslate nohighlight">\(P_{nl}(x)=\exp(x/2)X_{nl}(x)\)</span></p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>IPR_mat</strong> – the matrix of all IPR values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The inverse participation ratio for a state <cite>i</cite> is usually defined as</p>
<div class="math notranslate nohighlight">
\[\mathrm{IPR}_i = \int \mathrm{d}{\mathbf{r}} |\Psi_i(\mathbf{r})|^4\]</div>
<p>It is typically used as a localization measure.</p>
<p>WARNING: the current definition in this version is not mathematically correct.
It does not include the proper contribution from the spherical harmonics
<span class="math notranslate nohighlight">\(|Y_l^m(\theta,\phi)|^4\)</span>. This is omitted because it makes little difference
to the flavour of the results but complicates things. Currently, this function
does not correctly produce the expected limits (even if the spherical harmonic
contribution is correctly accounted for). Use at your own peril…</p>
</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.staticKS">
<span id="atomec-staticks-module"></span><h2>atoMEC.staticKS module<a class="headerlink" href="#module-atoMEC.staticKS" title="Permalink to this headline">¶</a></h2>
<p>The staticKS module handles time-indepenent KS quantities such as the KS orbitals.</p>
<p>This module is a ‘workhouse’ for much of the average-atom functionality.
Computation of static KS quantities is designed to be quite general.
The main assumption used everywhere is that we have a logarithmically spaced grid.</p>
<div class="section" id="id10">
<h3>Classes<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Orbitals</span></code></a> : Holds the KS orbitals (transformed to the log grid) and related                       quantities such as eigenvalues and occupation numbers</p></li>
<li><p><a class="reference internal" href="#atoMEC.staticKS.Density" title="atoMEC.staticKS.Density"><code class="xref py py-class docutils literal notranslate"><span class="pre">Density</span></code></a> : Holds the KS density (bound/unbound components) and routines                      to compute it.</p></li>
<li><p><a class="reference internal" href="#atoMEC.staticKS.Potential" title="atoMEC.staticKS.Potential"><code class="xref py py-class docutils literal notranslate"><span class="pre">Potential</span></code></a> : Holds the KS potential (split into individual components) and                        the routines to compute them.</p></li>
<li><p><a class="reference internal" href="#atoMEC.staticKS.Energy" title="atoMEC.staticKS.Energy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Energy</span></code></a> : Holds the free energy and all internal components (KS quantities                     and entropy) and the routines required to compute them.</p></li>
<li><p><a class="reference internal" href="#atoMEC.staticKS.EnergyAlt" title="atoMEC.staticKS.EnergyAlt"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyAlt</span></code></a> : Holds the free energy and all internal components (KS                        quantities and entropy) and the routines required to compute                        them. N.B. the <a class="reference internal" href="#atoMEC.staticKS.EnergyAlt" title="atoMEC.staticKS.EnergyAlt"><code class="xref py py-class docutils literal notranslate"><span class="pre">EnergyAlt</span></code></a> class constructs the energy                        functional in an alternative manner to the main <a class="reference internal" href="#atoMEC.staticKS.Energy" title="atoMEC.staticKS.Energy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Energy</span></code></a>                        class.</p></li>
</ul>
</div>
<div class="section" id="id11">
<h3>Functions<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.staticKS.log_grid" title="atoMEC.staticKS.log_grid"><code class="xref py py-func docutils literal notranslate"><span class="pre">log_grid()</span></code></a> : Sets up the logarithmic (and associated real-space) grid on which                      all computations rely.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.staticKS.Density">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.staticKS.</span></span><span class="sig-name descname"><span class="pre">Density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Density" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class holding the static KS density and routines required to compute its components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbs</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Orbitals</span></code></a>) – The KS orbitals object</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Density.construct_rho_orbs">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">construct_rho_orbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Density.construct_rho_orbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Density.construct_rho_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a density from a set of discrete KS orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the radial eigenfunctions on the xgrid</p></li>
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the orbital occupations</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dens</strong> – contains the keys <cite>rho</cite> and <cite>N</cite> denoting the density
and number of electrons respectively</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Density.construct_rho_unbound">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">construct_rho_unbound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Density.construct_rho_unbound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Density.construct_rho_unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the unbound part of the density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbs</strong> (<em>ndarray</em>) – the radial eigenfunctions on the xgrid</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rho_unbound</strong> – contains the keys <cite>rho</cite> and <cite>N</cite> denoting the unbound density
and number of unbound electrons respectively</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Density.bound">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">bound</span></span><a class="headerlink" href="#atoMEC.staticKS.Density.bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Bound part of KS density.</p>
<p>Contains the keys <cite>rho</cite> and <cite>N</cite> denoting the bound density and number of bound
electrons respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarrays</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Density.total">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">total</span></span><a class="headerlink" href="#atoMEC.staticKS.Density.total" title="Permalink to this definition">¶</a></dt>
<dd><p>Total KS density <span class="math notranslate nohighlight">\(n(r)\)</span> or <span class="math notranslate nohighlight">\(n(x)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Density.unbound">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">unbound</span></span><a class="headerlink" href="#atoMEC.staticKS.Density.unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Unbound part of KS density.</p>
<p>Contains the keys <cite>rho</cite> and <cite>N</cite> denoting the
unbound density and number of unbound electrons respectively</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarrays</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.staticKS.</span></span><span class="sig-name descname"><span class="pre">Energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class holding information about the KS total energy and relevant routines.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_E_en">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_E_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_E_en"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_E_en" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the electron-nuclear energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> (<em>ndarray</em>) – the (spin) KS density</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E_en</strong> – the electron-nuclear energy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Electron-nuclear energy is given by</p>
<div class="math notranslate nohighlight">
\[E_{en} = 4\pi\int_0^{r_s} \mathrm{d}{r} r^2 n(r) v_{en}(r),\]</div>
<p>where <span class="math notranslate nohighlight">\(r_s\)</span> denotes the radius of the sphere of interest</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_E_ha">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_E_ha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_E_ha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_E_ha" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Hartree energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> (<em>ndarray</em>) – the (spin) KS density</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E_ha</strong> – the Hartree energy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Hartree energy is given by</p>
<div class="math notranslate nohighlight">
\[E_\mathrm{ha} = 2\pi\int_0^{r_s}\mathrm{d}r r^2 n(r) v_\mathrm{ha}(r),\]</div>
<p>where <span class="math notranslate nohighlight">\(v_\mathrm{ha}(r)\)</span> is the Hartree potential</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_E_kin">
<span class="sig-name descname"><span class="pre">calc_E_kin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_E_kin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_E_kin" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the kinetic energy.</p>
<p>Kinetic energy is in general different for bound and unbound components.
This routine is a wrapper calling the respective functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbs</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Orbitals</span></code></a>) – the KS orbitals object</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E_kin</strong> – Contains <cite>tot</cite>, <cite>bound</cite> and <cite>unbound</cite> keys</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_E_kin_dens">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_E_kin_dens</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_E_kin_dens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_E_kin_dens" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the local kinetic energy density (KED).</p>
<p>There are multiple definitions in the literature of the local KED, see notes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the radial KS orbitals on the log grid</p></li>
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the orbital occupations</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>optional</em>) – the definition used for KED, can be ‘A’ or ‘B’ (see notes).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>e_kin_dens</strong> – the local kinetic energy density</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The methods ‘A’ and ‘B’ in this function are given according to the definitions
in <a class="footnote-reference brackets" href="#id15" id="id12">3</a> and <a class="footnote-reference brackets" href="#id16" id="id13">4</a>.</p>
<p>They of course (should) both integrate to the same kinetic energy. The
definition ‘B’ is the one used in the usual definition of the electron
localization function <a class="footnote-reference brackets" href="#id17" id="id14">5</a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id12">3</a></span></dt>
<dd><p>H. Jiang, The local kinetic energy density revisited,
New J. Phys. 22 103050 (2020), <a class="reference external" href="https://doi.org/10.1088/1367-2630/abbf5d">DOI:10.1088/1367-2630/abbf5d</a>.</p>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id13">4</a></span></dt>
<dd><p>L. Cohen, Local kinetic energy in quantum mechanics,
J. Chem. Phys. 70, 788 (1979), <a class="reference external" href="https://doi.org/10.1063/1.437511">DOI:10.1063/1.437511</a>.</p>
</dd>
<dt class="label" id="id17"><span class="brackets"><a class="fn-backref" href="#id14">5</a></span></dt>
<dd><p>A. Savin et al., Electron Localization in Solid-State Structures of the
Elements: the Diamond Structure, Angew. Chem. Int. Ed. Engl. 31: 187-188
(1992), <a class="reference external" href="https://doi.org/10.1002/anie.199201871">DOI:10.1002/anie.199201871</a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_E_kin_orbs">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_E_kin_orbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_E_kin_orbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_E_kin_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the kinetic energy contribution from discrete KS orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigfuncs</strong> (<em>ndarray</em>) – the radial KS orbitals on the log grid</p></li>
<li><p><strong>occnums</strong> (<em>ndarray</em>) – the orbital occupations</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E_kin</strong> – the kinetic energy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_E_kin_unbound">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_E_kin_unbound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigfuncs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_E_kin_unbound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_E_kin_unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the contribution from unbound (continuum) electrons to kinetic energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbs</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Orbitals</span></code></a>) – the KS orbitals object</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E_kin_unbound</strong> – the unbound kinetic energy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Currently only “ideal” (uniform) approximation for unbound electrons supported.</p>
<div class="math notranslate nohighlight">
\[T_\mathrm{ub} = \sum_\sigma \frac{N^\sigma\times V}{\sqrt{2}\pi^2}\
I_{3/2}(\mu,\beta),\]</div>
<p>where <span class="math notranslate nohighlight">\(I_{3/2}(\mu,\beta)\)</span> denotes the complete Fermi-Diract integral</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_S_orbs">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_S_orbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occnums</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_S_orbs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_S_orbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the KS (non-interacting) entropy for specified orbitals (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>occnums</strong> (<em>ndarray</em>) – orbital occupation numbers</p></li>
<li><p><strong>lmat</strong> (<em>ndarray</em>) – the degeneracy array (<span class="math notranslate nohighlight">\((2l+1)\)</span>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>S</strong> – the bound contribution to the entropy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The entropy of non-interacting (KS) electrons is given by:</p>
<div class="math notranslate nohighlight">
\[S_\mathrm{b} = -\sum_{s,l,n} (2l+1) [ f_{nls} \log(f_{nls}) \
               + (1-f_{nls}) (\log(1-f_{nls}) ]\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_S_unbound">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_S_unbound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">occnums_ub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lunbound</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_S_unbound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_S_unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the unbound contribution to the entropy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbs</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Orbitals</span></code></a>) – the KS orbitals object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>S_unbound</strong> – the unbound entropy term</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Currently only “ideal” (uniform) treatment of unbound electrons is supported.</p>
<div class="math notranslate nohighlight">
\[S_\mathrm{ub} = \sum_\sigma \frac{V}{\sqrt{2}\pi^2} I_{1/2}(\mu,\beta)\]</div>
<p>where <span class="math notranslate nohighlight">\(I_{1/2}(\mu,\beta)\)</span> is the complete Fermi-Dirac integral of order
<span class="math notranslate nohighlight">\(1/2\)</span></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.calc_entropy">
<span class="sig-name descname"><span class="pre">calc_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Energy.calc_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Energy.calc_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the KS entropy.</p>
<p>Entropy is in general different for bound and unbound orbitals.
This function is a wrapper which calls the respective functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbs</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Orbitals</span></code></a>) – the KS orbitals object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>S</strong> – contains <cite>tot</cite>, <cite>bound</cite> and <cite>unbound</cite> keys</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.E_en">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_en</span></span><a class="headerlink" href="#atoMEC.staticKS.Energy.E_en" title="Permalink to this definition">¶</a></dt>
<dd><p>The electron-nuclear energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.E_ha">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_ha</span></span><a class="headerlink" href="#atoMEC.staticKS.Energy.E_ha" title="Permalink to this definition">¶</a></dt>
<dd><p>The Hartree energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.E_kin">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_kin</span></span><a class="headerlink" href="#atoMEC.staticKS.Energy.E_kin" title="Permalink to this definition">¶</a></dt>
<dd><p>KS kinetic energy.</p>
<p>Contains <cite>bound</cite> and <cite>unbound</cite> keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">floats</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.E_tot">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_tot</span></span><a class="headerlink" href="#atoMEC.staticKS.Energy.E_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>The total KS internal energy.</p>
<p>Given by <span class="math notranslate nohighlight">\(E=T_\mathrm{s}+E_\mathrm{en}+E_\mathrm{ha}+F_\mathrm{xc}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.E_xc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_xc</span></span><a class="headerlink" href="#atoMEC.staticKS.Energy.E_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>The exchange-correlation energy.</p>
<p>Contains the keys <cite>x</cite>, <cite>c</cite> and <cite>xc</cite> for exchange,
correlation and exchange + correlation respectively</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">floats</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.F_tot">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">F_tot</span></span><a class="headerlink" href="#atoMEC.staticKS.Energy.F_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>The free energy.</p>
<p>Contains the keys <cite>F</cite>, <cite>E</cite> and <cite>S</cite> for free energy, internal energy and
total entropy. <span class="math notranslate nohighlight">\(F = E - TS\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">floats</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Energy.entropy">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">entropy</span></span><a class="headerlink" href="#atoMEC.staticKS.Energy.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>The total entropy.</p>
<p>Contains <cite>bound</cite> and <cite>unbound</cite> keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">floats</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.staticKS.</span></span><span class="sig-name descname"><span class="pre">EnergyAlt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#EnergyAlt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class holding information about the KS energy and associated routines.</p>
<p>N.B. this computes the total energy functional in an alternative way to the main
<a class="reference internal" href="#atoMEC.staticKS.Energy" title="atoMEC.staticKS.Energy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Energy</span></code></a> object. In this class, the total energy is first calculated from the
sum of the eigenvalues and then <span class="math notranslate nohighlight">\(\int \mathrm{d}r v_\mathrm{Hxc}(r) n(r)\)</span>
is subtracted to obtain the sum over kinetic and electron-nuclear energies.</p>
<p>In general, this gives a different result compared to the <a class="reference internal" href="#atoMEC.staticKS.Energy" title="atoMEC.staticKS.Energy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Energy</span></code></a>, due
to the way the unbound electrons are treated. Which result is ‘correct’ depends on
how we interpret the unbound energy (i.e., is it purely a kinetic term or not).</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.calc_E_v_hxc">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_E_v_hxc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#EnergyAlt.calc_E_v_hxc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.calc_E_v_hxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the compensating integral term over the Hxc-potential (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dens</strong> (<em>ndarray</em>) – the (spin) KS density</p></li>
<li><p><strong>pot</strong> (<a class="reference internal" href="#atoMEC.staticKS.Potential" title="atoMEC.staticKS.Potential"><code class="xref py py-class docutils literal notranslate"><span class="pre">Potential</span></code></a>) – the KS potential object</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>E_v_hxc</strong> – the compensating Hxc-potential integral</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In this construction of the KS energy functional, the sum over the KS
eigenvalues must be compensated by an integral of the Hxc-potential.
This integral is given by:</p>
<div class="math notranslate nohighlight">
\[E = 4\pi\sum_\sigma\int \mathrm{d}r r^2 n^\sigma(r) v_\mathrm{Hxc}^\sigma(r)\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.calc_entropy">
<span class="sig-name descname"><span class="pre">calc_entropy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#EnergyAlt.calc_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.calc_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the KS entropy.</p>
<p>Entropy is in general different for bound and unbound orbitals.
This function is a wrapper which calls the respective functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbs</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Orbitals</span></code></a>) – the KS orbitals object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>S</strong> – contains <cite>tot</cite>, <cite>bound</cite> and <cite>unbound</cite> keys</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.E_eps">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_eps</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.E_eps" title="Permalink to this definition">¶</a></dt>
<dd><p>The sum of the (weighted) eigenvalues.</p>
<p>Given by <span class="math notranslate nohighlight">\(E=\sum_{nl\sigma} (2l+1) f_{nl}^\sigma \epsilon_{nl}^\sigma\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.E_ha">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_ha</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.E_ha" title="Permalink to this definition">¶</a></dt>
<dd><p>The Hartree energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.E_tot">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_tot</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.E_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>The total KS internal energy.</p>
<p>Given by <span class="math notranslate nohighlight">\(E=T_\mathrm{s}+E_\mathrm{en}+E_\mathrm{ha}+F_\mathrm{xc}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.E_unbound">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_unbound</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.E_unbound" title="Permalink to this definition">¶</a></dt>
<dd><p>The energy of the unbound part of the electron density.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.E_v_hxc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_v_hxc</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.E_v_hxc" title="Permalink to this definition">¶</a></dt>
<dd><p>The integral <span class="math notranslate nohighlight">\(\int \mathrm{d}r v_\mathrm{Hxc}(r) n(r)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.E_xc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_xc</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.E_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>The exchange-correlation energy.</p>
<p>Contains the keys <cite>x</cite>, <cite>c</cite> and <cite>xc</cite> for exchange,
correlation and exchange + correlation respectively</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">floats</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.F_tot">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">F_tot</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.F_tot" title="Permalink to this definition">¶</a></dt>
<dd><p>The free energy.</p>
<p>Contains the keys <cite>F</cite>, <cite>E</cite> and <cite>S</cite> for free energy, internal energy and
total entropy. <span class="math notranslate nohighlight">\(F = E - TS\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">floats</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.EnergyAlt.entropy">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">entropy</span></span><a class="headerlink" href="#atoMEC.staticKS.EnergyAlt.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>The total entropy.</p>
<p>Contains <cite>bound</cite> and <cite>unbound</cite> keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">floats</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.staticKS.</span></span><span class="sig-name descname"><span class="pre">Orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Orbitals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Orbitals" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class holding the KS orbitals, associated quantities and relevant routines.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.calc_occnums">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_occnums</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Orbitals.calc_occnums"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Orbitals.calc_occnums" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Fermi-Dirac occupations for the eigenvalues.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigvals</strong> (<em>ndarray</em>) – the KS eigenvalues</p></li>
<li><p><strong>lbound</strong> (<em>ndarray</em>) – the array of bound eigenvalues</p></li>
<li><p><strong>mu</strong> (<em>aray_like</em>) – the chemical potential</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>occnums</strong> – the orbital occupations multiplied with (2l+1) degeneracy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Orbitals.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Orbitals.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the orbitals and their eigenvalues with the given potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>potential</strong> (<em>ndarray</em>) – the KS (or alternatively chosen) potential</p></li>
<li><p><strong>init</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether orbitals are being computed for first time</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.make_lbound">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">make_lbound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Orbitals.make_lbound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Orbitals.make_lbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the lbound matrix denoting the bound states and their degeneracies.</p>
<p>For each spin channel,
<span class="math notranslate nohighlight">\(L^\mathrm{B}_{ln}=(2l+1)\times\Theta(\epsilon_{nl})\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eigvals</strong> (<em>ndarray</em>) – the KS orbital eigenvalues</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>lbound_mat</strong> – the lbound matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.make_lunbound">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">make_lunbound</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigvals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Orbitals.make_lunbound"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Orbitals.make_lunbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the lunbound matrix denoting the unbound states and degeneracies.</p>
<p>For each spin channel,
<span class="math notranslate nohighlight">\(L^\mathrm{B}_{ln}=(2l+1)\times\Theta(\epsilon_{nl})\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eigvals</strong> (<em>ndarray</em>) – the KS orbital eigenvalues</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>lunbound_mat</strong> – the lbound matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.occupy">
<span class="sig-name descname"><span class="pre">occupy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Orbitals.occupy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Orbitals.occupy" title="Permalink to this definition">¶</a></dt>
<dd><p>Occupy the KS orbitals according to Fermi-Dirac statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.eigfuncs">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">eigfuncs</span></span><a class="headerlink" href="#atoMEC.staticKS.Orbitals.eigfuncs" title="Permalink to this definition">¶</a></dt>
<dd><p>The radial KS eigenfunctions on the logarithmic grid.</p>
<p>Related to real-grid KS radial orbitals by
<span class="math notranslate nohighlight">\(X_{nl}^{\sigma}(x)=e^{x/2} R_{nl}^{\sigma}(r).\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.eigvals">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">eigvals</span></span><a class="headerlink" href="#atoMEC.staticKS.Orbitals.eigvals" title="Permalink to this definition">¶</a></dt>
<dd><p>The KS eigenvalues <span class="math notranslate nohighlight">\(\epsilon_{nl}^\sigma\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.lbound">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">lbound</span></span><a class="headerlink" href="#atoMEC.staticKS.Orbitals.lbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix denoting bound eigenvalues and their degeneracies (DOS).</p>
<p>The matrix takes the form
<span class="math notranslate nohighlight">\(L^\mathrm{B}_{ln}=(2l+1)\times\Theta(\epsilon_{nl}).\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.lunbound">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">lunbound</span></span><a class="headerlink" href="#atoMEC.staticKS.Orbitals.lunbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix denoting bound eigenvalues and their degeneracies (DOS).</p>
<p>The matrix takes the form
<span class="math notranslate nohighlight">\(L^\mathrm{B}_{ln}=(2l+1)\times\Theta(\epsilon_{nl}).\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.occnums">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">occnums</span></span><a class="headerlink" href="#atoMEC.staticKS.Orbitals.occnums" title="Permalink to this definition">¶</a></dt>
<dd><p>KS occupation numbers (Fermi-Dirac).</p>
<p>The occupation numbers are multiplied by the <a class="reference internal" href="#atoMEC.staticKS.Orbitals.lbound" title="atoMEC.staticKS.Orbitals.lbound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lbound</span></code></a> (degeneracy) matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Orbitals.occnums_ub">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">occnums_ub</span></span><a class="headerlink" href="#atoMEC.staticKS.Orbitals.occnums_ub" title="Permalink to this definition">¶</a></dt>
<dd><p>KS occupation numbers (Fermi-Dirac).</p>
<p>The occupation numbers are multiplied by the <a class="reference internal" href="#atoMEC.staticKS.Orbitals.lbound" title="atoMEC.staticKS.Orbitals.lbound"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lbound</span></code></a> (degeneracy) matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.staticKS.Potential">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.staticKS.</span></span><span class="sig-name descname"><span class="pre">Potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Potential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class holding the KS potential and the routines required to compute it.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Potential.calc_v_en">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_v_en</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Potential.calc_v_en"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Potential.calc_v_en" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the electron-nuclear potential.</p>
<p>The electron-nuclear potential is given by
<span class="math notranslate nohighlight">\(v_\mathrm{en} (x) = -Z * \exp(-x)\)</span>
on the logarithmic grid</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.staticKS.Potential.calc_v_ha">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">calc_v_ha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#Potential.calc_v_ha"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.Potential.calc_v_ha" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the Hartree potential (see notes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> (<em>ndarray</em>) – the total KS density</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the logarithmic grid</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><span class="math notranslate nohighlight">\(v_\mathrm{ha}\)</span> is defined on the r-grid as:</p>
<div class="math notranslate nohighlight">
\[v_\mathrm{ha}(r) = 4\pi\int_0^r \mathrm{d}r' r'^2 \frac{n(r')}{\max(r,r')}\]</div>
<p>On the x-grid:</p>
<div class="math notranslate nohighlight">
\[v_\mathrm{ha}(x) = 4\pi\Big\{\exp(-x)\int_{x0}^x \mathrm{d}x' n(x') \
\exp(3x') -\int_x^{\log(r_s)} \mathrm{d}x' n(x') \exp(2x') \Big\}\]</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Potential.v_en">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">v_en</span></span><a class="headerlink" href="#atoMEC.staticKS.Potential.v_en" title="Permalink to this definition">¶</a></dt>
<dd><p>The electron-nuclear potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Potential.v_ha">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">v_ha</span></span><a class="headerlink" href="#atoMEC.staticKS.Potential.v_ha" title="Permalink to this definition">¶</a></dt>
<dd><p>The Hartree potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Potential.v_s">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">v_s</span></span><a class="headerlink" href="#atoMEC.staticKS.Potential.v_s" title="Permalink to this definition">¶</a></dt>
<dd><p>The full KS potential.</p>
<p>Given by <span class="math notranslate nohighlight">\(v_\mathrm{s} = v_\mathrm{en} + v_\mathrm{ha} + v_\mathrm{xc}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.staticKS.Potential.v_xc">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">v_xc</span></span><a class="headerlink" href="#atoMEC.staticKS.Potential.v_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>The exchange-correlation potential.</p>
<p>Contains the keys <cite>x</cite>, <cite>c</cite> and <cite>xc</cite> denoting exchange, correlation,
and exchange + correlation respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code> of <code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarrays</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.staticKS.log_grid">
<span class="sig-prename descclassname"><span class="pre">atoMEC.staticKS.</span></span><span class="sig-name descname"><span class="pre">log_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_r</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/staticKS.html#log_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.staticKS.log_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the logarithmic (and real) grid, defined up to x_r.</p>
<p>The leftmost grid point is given by the <cite>config.grid_params[“x0”]</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x_r</strong> (<em>float</em>) – The RHS grid point (in logarithmic space)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xgrid, rgrid</strong> – The grids in logarithmic (x) and real (r) space</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of ndarrays</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.unitconv">
<span id="atomec-unitconv-module"></span><h2>atoMEC.unitconv module<a class="headerlink" href="#module-atoMEC.unitconv" title="Permalink to this headline">¶</a></h2>
<p>Contains unit conversions.</p>
</div>
<div class="section" id="module-atoMEC.writeoutput">
<span id="atomec-writeoutput-module"></span><h2>atoMEC.writeoutput module<a class="headerlink" href="#module-atoMEC.writeoutput" title="Permalink to this headline">¶</a></h2>
<p>Contains the routines which generate printed output (to screen and separate files).</p>
<div class="section" id="id18">
<h3>Classes<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.writeoutput.SCF" title="atoMEC.writeoutput.SCF"><code class="xref py py-class docutils literal notranslate"><span class="pre">SCF</span></code></a> : Write information about the self-consistent field (SCF) cycle.</p></li>
</ul>
</div>
<div class="section" id="id19">
<h3>Functions<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.writeoutput.write_atomic_data" title="atoMEC.writeoutput.write_atomic_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_atomic_data()</span></code></a> : Write information about the main Atom object.</p></li>
<li><p><a class="reference internal" href="#atoMEC.writeoutput.write_ISModel_data" title="atoMEC.writeoutput.write_ISModel_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_ISModel_data()</span></code></a> : Write information about the IS model.</p></li>
<li><p><a class="reference internal" href="#atoMEC.writeoutput.density_to_csv" title="atoMEC.writeoutput.density_to_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">density_to_csv()</span></code></a> : Write the KS density to file.</p></li>
<li><p><a class="reference internal" href="#atoMEC.writeoutput.potential_to_csv" title="atoMEC.writeoutput.potential_to_csv"><code class="xref py py-func docutils literal notranslate"><span class="pre">potential_to_csv()</span></code></a> : Write the KS potential to file.</p></li>
<li><p><a class="reference internal" href="#atoMEC.writeoutput.timing" title="atoMEC.writeoutput.timing"><code class="xref py py-func docutils literal notranslate"><span class="pre">timing()</span></code></a>: Generate timing information for given input function.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.writeoutput.SCF">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.writeoutput.</span></span><span class="sig-name descname"><span class="pre">SCF</span></span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#SCF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.SCF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Write information about the self-consistent field (SCF) cycle.</p>
<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.writeoutput.SCF.write_cycle">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">write_cycle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iscf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E_free</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#SCF.write_cycle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.SCF.write_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Write output string for each SCF iteration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iscf</strong> (<em>int</em>) – the iteration number</p></li>
<li><p><strong>E_free</strong> (<em>float</em>) – the total free energy</p></li>
<li><p><strong>conv_vals</strong> (<em>dict</em>) – dictionary of convergence values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_str</strong> – free energy and convergence values for the i-th iteration</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.writeoutput.SCF.write_final">
<span class="sig-name descname"><span class="pre">write_final</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">orbitals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#SCF.write_final"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.SCF.write_final" title="Permalink to this definition">¶</a></dt>
<dd><p>Write final post-SCF information about energy, orbitals and convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy</strong> (<a class="reference internal" href="#atoMEC.staticKS.Energy" title="atoMEC.staticKS.Energy"><em>staticKS.Energy</em></a>) – the energy object</p></li>
<li><p><strong>orbitals</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><em>staticKS.Orbitals</em></a>) – the orbitals object</p></li>
<li><p><strong>density</strong> (<a class="reference internal" href="#atoMEC.staticKS.Density" title="atoMEC.staticKS.Density"><em>staticKS.Density</em></a>) – the density object</p></li>
<li><p><strong>conv_vals</strong> (<em>dict</em>) – dictionary of convergence values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_str</strong> – information about whether the calculation converged, the final energies
(broken down into components), and the orbital energies and occupations</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.writeoutput.SCF.write_final_energies">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">write_final_energies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#SCF.write_final_energies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.SCF.write_final_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Write formatted KS energy information (by component).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>energy</strong> (<a class="reference internal" href="#atoMEC.staticKS.Energy" title="atoMEC.staticKS.Energy"><em>staticKS.Energy</em></a>) – the KS energy object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_str</strong> – formatted output string of energies by component</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.writeoutput.SCF.write_init">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">write_init</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#SCF.write_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.SCF.write_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the initial spiel for an SCF calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>None</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_str</strong> – header string for SCF cycle</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="atoMEC.writeoutput.SCF.write_orb_info">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">write_orb_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">orbitals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#SCF.write_orb_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.SCF.write_orb_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Write formatted KS orbital information.</p>
<p>Information up to to the highest occupied level +1 (for both n and l)
is included; remaining levels are truncated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>orbitals</strong> (<a class="reference internal" href="#atoMEC.staticKS.Orbitals" title="atoMEC.staticKS.Orbitals"><em>staticKS.Orbitals</em></a>) – the KS orbitals object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>eigs_occs</strong> – a tuple containing formatted eigenvalue table eigval_tbl,
and formatted occupation numbers table occnum_tbl</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple[str,str]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.writeoutput.density_to_csv">
<span class="sig-prename descclassname"><span class="pre">atoMEC.writeoutput.</span></span><span class="sig-name descname"><span class="pre">density_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#density_to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.density_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the density (on the r-grid) to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rgrid</strong> (<em>ndarray</em>) – real-space grid</p></li>
<li><p><strong>density</strong> (<a class="reference internal" href="#atoMEC.staticKS.Density" title="atoMEC.staticKS.Density"><em>staticKS.Density</em></a>) – the KS density object</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – name of the file to write to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.writeoutput.potential_to_csv">
<span class="sig-prename descclassname"><span class="pre">atoMEC.writeoutput.</span></span><span class="sig-name descname"><span class="pre">potential_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">potential</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#potential_to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.potential_to_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the potential (on the r-grid) to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rgrid</strong> (<em>ndarray</em>) – real-space grid</p></li>
<li><p><strong>density</strong> (<a class="reference internal" href="#atoMEC.staticKS.Potential" title="atoMEC.staticKS.Potential"><em>staticKS.Potential</em></a>) – the KS potential object</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – name of the file to write to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.writeoutput.timing">
<span class="sig-prename descclassname"><span class="pre">atoMEC.writeoutput.</span></span><span class="sig-name descname"><span class="pre">timing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#timing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.timing" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate timing information for given input function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> (<em>func</em>) – the function to be timed</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.writeoutput.write_ISModel_data">
<span class="sig-prename descclassname"><span class="pre">atoMEC.writeoutput.</span></span><span class="sig-name descname"><span class="pre">write_ISModel_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ISModel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#write_ISModel_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.write_ISModel_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Write information about the approximations used for the IS model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ISModel</strong> (<a class="reference internal" href="#atoMEC.models.ISModel" title="atoMEC.models.ISModel"><em>models.ISModel</em></a>) – The ISModel object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_str</strong> – formatted description of the ISModel attributes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.writeoutput.write_atomic_data">
<span class="sig-prename descclassname"><span class="pre">atoMEC.writeoutput.</span></span><span class="sig-name descname"><span class="pre">write_atomic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/writeoutput.html#write_atomic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.writeoutput.write_atomic_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Write information about the main Atom object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom</strong> (<a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><em>atoMEC.Atom</em></a>) – the main Atom object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output_str</strong> – formatted description of the Atom attributes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC.xc">
<span id="atomec-xc-module"></span><h2>atoMEC.xc module<a class="headerlink" href="#module-atoMEC.xc" title="Permalink to this headline">¶</a></h2>
<p>The xc module calculates exchange-correlation energies and potentials.</p>
<p>Mostly it sets up inputs and makes appropriate calls to the libxc package.
It also includes a class for customized xc-functionals and checks the
validity of inputs.</p>
<div class="section" id="id20">
<h3>Classes<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.xc.XCFunc" title="atoMEC.xc.XCFunc"><code class="xref py py-class docutils literal notranslate"><span class="pre">XCFunc</span></code></a> : handles atoMEC-defined functionals (not part of libxc package)</p></li>
</ul>
</div>
<div class="section" id="id21">
<h3>Functions<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.xc.check_xc_func" title="atoMEC.xc.check_xc_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_xc_func()</span></code></a> : check the xc func input is recognised and valid for atoMEC</p></li>
<li><p><a class="reference internal" href="#atoMEC.xc.set_xc_func" title="atoMEC.xc.set_xc_func"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_xc_func()</span></code></a>   : initialize the xc functional object</p></li>
<li><p><a class="reference internal" href="#atoMEC.xc.v_xc" title="atoMEC.xc.v_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">v_xc()</span></code></a>          : return the xc potential on the grid</p></li>
<li><p><a class="reference internal" href="#atoMEC.xc.E_xc" title="atoMEC.xc.E_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">E_xc()</span></code></a>          : return the xc energy</p></li>
<li><p><a class="reference internal" href="#atoMEC.xc.calc_xc" title="atoMEC.xc.calc_xc"><code class="xref py py-func docutils literal notranslate"><span class="pre">calc_xc()</span></code></a>       : compute the xc energy or potential depending on arguments</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.xc.XCFunc">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.xc.</span></span><span class="sig-name descname"><span class="pre">XCFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/xc.html#XCFunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.xc.XCFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Defines the XCFunc object for ‘special’ (non-libxc) funcs.</p>
<p>This is desgined to align with some proprerties of libxc func objects
in order to make certain general calls more straightforward</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xc_code</strong> (<em>str</em>) – the string identifier for the x/c func</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The XCFunc object contains no public attributes, but it does contain
the following private attributes (named so to match libxc):</p>
<dl class="simple">
<dt>_xc_code<span class="classifier">str</span></dt><dd><p>the string identifier for the x/c functional (not a libxc attribute)</p>
</dd>
<dt>_xc_func_name<span class="classifier">str</span></dt><dd><p>name of the functional</p>
</dd>
<dt>_number<span class="classifier">int</span></dt><dd><p>functional id</p>
</dd>
<dt>_family<span class="classifier">str</span></dt><dd><p>the family to which the xc functional belongs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.xc.E_xc">
<span class="sig-prename descclassname"><span class="pre">atoMEC.xc.</span></span><span class="sig-name descname"><span class="pre">E_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfunc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/xc.html#E_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.xc.E_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the xc energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> (<em>ndarray</em>) – the KS density on the log grid</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the log grid</p></li>
<li><p><strong>xfunc</strong> (<a class="reference internal" href="#atoMEC.xc.XCFunc" title="atoMEC.xc.XCFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XCFunc</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">pylibxc.LibXCFunctional</span></code>) – the exchange functional object</p></li>
<li><p><strong>cfunc</strong> (<a class="reference internal" href="#atoMEC.xc.XCFunc" title="atoMEC.xc.XCFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XCFunc</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">pylibxc.LibXCFunctional</span></code>) – the correlation functional object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>_E_xc</strong> – dictionary containing terms <cite>x</cite>, <cite>c</cite> and <cite>xc</cite> for exchange, correlation
and exchange + correlation respectively</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.xc.calc_xc">
<span class="sig-prename descclassname"><span class="pre">atoMEC.xc.</span></span><span class="sig-name descname"><span class="pre">calc_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xctype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/xc.html#calc_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.xc.calc_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the x/c energy density or potential depending on <cite>xctype</cite> input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> (<em>ndarray</em>) – the KS density on the log grid</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the log grid</p></li>
<li><p><strong>xcfunc</strong> (<a class="reference internal" href="#atoMEC.xc.XCFunc" title="atoMEC.xc.XCFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XCFunc</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">pylibxc.LibXCFunctional</span></code>) – the exchange or correlation functional object</p></li>
<li><p><strong>xctype</strong> (<em>str</em>) – the quantity to return, <cite>e_xc</cite> for energy density or <cite>v_xc</cite> for potential</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xc_arr</strong> – xc energy density or potential depending on <cite>xctype</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.xc.check_xc_func">
<span class="sig-prename descclassname"><span class="pre">atoMEC.xc.</span></span><span class="sig-name descname"><span class="pre">check_xc_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_supp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/xc.html#check_xc_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.xc.check_xc_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the xc input string or id is valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xc_code</strong> (<em>str</em><em> or </em><em>int</em>) – the name or libxc id of the xc functional</p></li>
<li><p><strong>id_supp</strong> (<em>list of ints</em>) – supported families of xc functional</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xc_func_name</strong> – the xc functional name</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.xc.set_xc_func">
<span class="sig-prename descclassname"><span class="pre">atoMEC.xc.</span></span><span class="sig-name descname"><span class="pre">set_xc_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xc_code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/xc.html#set_xc_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.xc.set_xc_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the xc functional object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>xc_code</strong> (<em>str</em><em> or </em><em>int</em>) – the name or id of the libxc functional</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>xc_func</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#atoMEC.xc.XCFunc" title="atoMEC.xc.XCFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XCFunc</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">pylibxc.LibXCFunctional</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="atoMEC.xc.v_xc">
<span class="sig-prename descclassname"><span class="pre">atoMEC.xc.</span></span><span class="sig-name descname"><span class="pre">v_xc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">density</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xgrid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xfunc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cfunc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC/xc.html#v_xc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.xc.v_xc" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrive the xc potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density</strong> (<em>ndarray</em>) – the KS density on the log grid</p></li>
<li><p><strong>xgrid</strong> (<em>ndarray</em>) – the log grid</p></li>
<li><p><strong>xfunc</strong> (<a class="reference internal" href="#atoMEC.xc.XCFunc" title="atoMEC.xc.XCFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XCFunc</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">pylibxc.LibXCFunctional</span></code>) – the exchange functional object</p></li>
<li><p><strong>cfunc</strong> (<a class="reference internal" href="#atoMEC.xc.XCFunc" title="atoMEC.xc.XCFunc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XCFunc</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">pylibxc.LibXCFunctional</span></code>) – the correlation functional object</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>_v_xc</strong> – dictionary containing terms <cite>x</cite>, <cite>c</cite> and <cite>xc</cite> for exchange, correlation
and exchange + correlation respectively</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict of ndarrays</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-atoMEC">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-atoMEC" title="Permalink to this headline">¶</a></h2>
<p>atoMEC: Average-atom code for matter under extreme conditions.</p>
<p>Copyright (c) 2021 (in alphabetical order), Tim Callow, Attila Cangi, Eli Kraisler.
All rights reserved.</p>
<p>atoMEC is a python-based average-atom code for simulations of high energy density
phenomena such as in warm dense matter.
Please see the README or the project wiki (<a class="reference external" href="https://atomec-project.github.io/atoMEC/">https://atomec-project.github.io/atoMEC/</a>)
for more information.</p>
<div class="section" id="id22">
<h3>Classes<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> : the main object for atoMEC calculations, containing information                   about physical material properties</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="atoMEC.Atom">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">atoMEC.</span></span><span class="sig-name descname"><span class="pre">Atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_temp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ha'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bohr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units_density</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'g/cm3'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/atoMEC.html#Atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#atoMEC.Atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The principal object in atoMEC calculations which defines the material properties.</p>
<p>The <cite>Atom</cite> contains key information about the physical properties of the material
such as temperature, density, and charge. It does not contain any information about approximations or choices of model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>species</strong> (<em>str</em>) – The chemical symbol for the atomic species, eg “He”</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – The electronic temperature in hartree, eV or Kelvin</p></li>
<li><p><strong>radius</strong> (<em>float</em><em>, </em><em>optional</em>) – The radius of the Wigner-Seitz sphere, defined as 0.5*a_i,
where a_i is the average inter-atomic distance</p></li>
<li><p><strong>density</strong> (<em>float</em><em>, </em><em>optional</em>) – The mass density of the material in <span class="math notranslate nohighlight">\(\mathrm{g\ cm}^{-3}\)</span></p></li>
<li><p><strong>charge</strong> (<em>int</em><em>, </em><em>optional</em>) – The overall net charge</p></li>
<li><p><strong>units_temp</strong> (<em>str</em><em>, </em><em>optional</em>) – The units of temperature, must be one of “ha”, “ev” or “k”</p></li>
<li><p><strong>units_radius</strong> (<em>str</em><em>, </em><em>optional</em>) – The units of radius, must be one of “ang” or “bohr”</p></li>
<li><p><strong>units_density</strong> (<em>str</em><em>, </em><em>optional</em>) – The units of density, currently only “g/cm3” is supported</p></li>
<li><p><strong>write_output</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to print atomic information, defaults True</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.E_Fermi">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">E_Fermi</span></span><a class="headerlink" href="#atoMEC.Atom.E_Fermi" title="Permalink to this definition">¶</a></dt>
<dd><p>the Fermi energy.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.WS_radius">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">WS_radius</span></span><a class="headerlink" href="#atoMEC.Atom.WS_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>the Wigner-Seitz radius, or the electron coupling parameter.</p>
<p>The Wigner-Seitz radius differs from the Voronoi radius because it depends on
the free electron density, defined in atoMEC as the valence electron density.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.at_chrg">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">at_chrg</span></span><a class="headerlink" href="#atoMEC.Atom.at_chrg" title="Permalink to this definition">¶</a></dt>
<dd><p>the atomic charge Z.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.at_mass">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">at_mass</span></span><a class="headerlink" href="#atoMEC.Atom.at_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>the atomic mass (in a.u.).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.charge">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">charge</span></span><a class="headerlink" href="#atoMEC.Atom.charge" title="Permalink to this definition">¶</a></dt>
<dd><p>the net charge of the atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.density">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">density</span></span><a class="headerlink" href="#atoMEC.Atom.density" title="Permalink to this definition">¶</a></dt>
<dd><p>the mass density of the material in <span class="math notranslate nohighlight">\(\mathrm{g\ cm}^{-3}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.gamma_ion">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">gamma_ion</span></span><a class="headerlink" href="#atoMEC.Atom.gamma_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>the ionic coupling parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.info">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">info</span></span><a class="headerlink" href="#atoMEC.Atom.info" title="Permalink to this definition">¶</a></dt>
<dd><p>formatted information about the <a class="reference internal" href="#atoMEC.Atom" title="atoMEC.Atom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Atom</span></code></a>’s attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.nele">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">nele</span></span><a class="headerlink" href="#atoMEC.Atom.nele" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of electrons in the atom.</p>
<p>The total electron number is given by the sum of <a class="reference internal" href="#atoMEC.Atom.at_chrg" title="atoMEC.Atom.at_chrg"><code class="xref py py-obj docutils literal notranslate"><span class="pre">at_chrg</span></code></a>
and <a class="reference internal" href="#atoMEC.Atom.charge" title="atoMEC.Atom.charge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">charge</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.nvalence">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">nvalence</span></span><a class="headerlink" href="#atoMEC.Atom.nvalence" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of valence electrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.radius">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">radius</span></span><a class="headerlink" href="#atoMEC.Atom.radius" title="Permalink to this definition">¶</a></dt>
<dd><p>radius of the Voronoi sphere.</p>
<p>The radius is defined as <span class="math notranslate nohighlight">\(a_i /2\)</span>,
where <span class="math notranslate nohighlight">\(a_i\)</span> is the average inter-atomic distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.species">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">species</span></span><a class="headerlink" href="#atoMEC.Atom.species" title="Permalink to this definition">¶</a></dt>
<dd><p>the chemical symbol for the atomic species.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.temp">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temp</span></span><a class="headerlink" href="#atoMEC.Atom.temp" title="Permalink to this definition">¶</a></dt>
<dd><p>the electronic temperature in Hartree.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.theta_e">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">theta_e</span></span><a class="headerlink" href="#atoMEC.Atom.theta_e" title="Permalink to this definition">¶</a></dt>
<dd><p>the electron degeneracy parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.units_density">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">units_density</span></span><a class="headerlink" href="#atoMEC.Atom.units_density" title="Permalink to this definition">¶</a></dt>
<dd><p>the units of the atomic density.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.units_radius">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">units_radius</span></span><a class="headerlink" href="#atoMEC.Atom.units_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>the units of the atomic radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="atoMEC.Atom.units_temp">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">units_temp</span></span><a class="headerlink" href="#atoMEC.Atom.units_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>the units of temperature.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="modules.html" class="btn btn-neutral float-left" title="atoMEC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, CASUS.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>